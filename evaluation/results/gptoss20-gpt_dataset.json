[
  {
    "prompt": "Return the 12 months of 2023 with total revenue and total units sold; columns: month_start, total_revenue, total_units; order by month_start ASC.",
    "gt_sql": "SELECT DATE_TRUNC('month', Sold_Date) AS month_start, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales WHERE CAST(Sold_Date AS VARCHAR) LIKE '2023%' GROUP BY DATE_TRUNC('month', Sold_Date) ORDER BY month_start ASC",
    "gt_data": "   month_start  total_revenue  total_units\n0   2023-01-01  434172.808300      33653.0\n1   2023-02-01  411762.718244      31545.0\n2   2023-03-01  423070.838309      32460.0\n3   2023-04-01  384479.678311      30199.0\n4   2023-05-01  381326.428023      31154.0\n5   2023-06-01  364806.737856      29082.0\n6   2023-07-01  353284.207838      27932.0\n7   2023-08-01  401061.537729      31903.0\n8   2023-09-01  422554.967469      31847.0\n9   2023-10-01  454231.057104      38208.0\n10  2023-11-01  511104.287418      41043.0\n11  2023-12-01  874263.668331      60941.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_0_gt.csv",
    "gen_sql": "SELECT DATE_TRUNC('month', Sold_Date) AS month_start,\n       SUM(Total_Sale_Value) AS total_revenue,\n       SUM(Qty_Sold) AS total_units\nFROM sales\nWHERE Sold_Date >= '2023-01-01' AND Sold_Date < '2024-01-01'\nGROUP BY month_start\nORDER BY month_start ASC;",
    "gen_data": "   month_start  total_revenue  total_units\n0   2023-01-01  434172.808300      33653.0\n1   2023-02-01  411762.718244      31545.0\n2   2023-03-01  423070.838309      32460.0\n3   2023-04-01  384479.678311      30199.0\n4   2023-05-01  381326.428023      31154.0\n5   2023-06-01  364806.737856      29082.0\n6   2023-07-01  353284.207838      27932.0\n7   2023-08-01  401061.537729      31903.0\n8   2023-09-01  422554.967469      31847.0\n9   2023-10-01  454231.057104      38208.0\n10  2023-11-01  511104.287418      41043.0\n11  2023-12-01  874263.668331      60941.0",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_0_gen.csv"
  },
  {
    "prompt": "Return the top 20 SKUs by total units sold across the full dataset; tie-break by higher total revenue, then SKU_Coded ASC; columns: SKU_Coded, total_units, total_revenue.",
    "gt_sql": "SELECT SKU_Coded, SUM(Qty_Sold) AS total_units, SUM(Total_Sale_Value) AS total_revenue FROM sales GROUP BY SKU_Coded ORDER BY total_units DESC, total_revenue DESC, SKU_Coded ASC LIMIT 20",
    "gt_data": "    SKU_Coded  total_units  total_revenue\n0     6200700      52262.0  515088.125879\n1     6194250      14905.0  296872.717907\n2     6193800      13744.0  102779.887266\n3     6177750      12982.0   24268.139672\n4     6177350      12702.0  107732.197505\n5     6200650      12599.0  125459.188012\n6     6187750      11909.0   94285.607714\n7     6191100      11750.0   93128.078166\n8     6190100      11293.0   14756.900020\n9     6200800      10577.0   25954.219908\n10    6179250       9731.0  145054.308485\n11    6179200       9411.0   52888.138254\n12    6192300       8845.0   35013.700175\n13    6195800       8676.0   84304.989587\n14    6182050       8539.0   67969.048205\n15    6173350       8419.0   73853.650037\n16    6177450       8396.0   41803.148624\n17    6184100       7988.0  158712.088621\n18    6201750       7931.0    7774.890016\n19    6178100       7911.0   39385.088725",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_1_gt.csv",
    "gen_sql": "SELECT SKU_Coded,\n       SUM(Qty_Sold) AS total_units,\n       SUM(Total_Sale_Value) AS total_revenue\nFROM sales\nGROUP BY SKU_Coded\nORDER BY total_units DESC,\n         total_revenue DESC,\n         SKU_Coded ASC\nLIMIT 20;",
    "gen_data": "    SKU_Coded  total_units  total_revenue\n0     6200700      52262.0  515088.125879\n1     6194250      14905.0  296872.717907\n2     6193800      13744.0  102779.887266\n3     6177750      12982.0   24268.139672\n4     6177350      12702.0  107732.197505\n5     6200650      12599.0  125459.188012\n6     6187750      11909.0   94285.607714\n7     6191100      11750.0   93128.078166\n8     6190100      11293.0   14756.900020\n9     6200800      10577.0   25954.219908\n10    6179250       9731.0  145054.308485\n11    6179200       9411.0   52888.138254\n12    6192300       8845.0   35013.700175\n13    6195800       8676.0   84304.989587\n14    6182050       8539.0   67969.048205\n15    6173350       8419.0   73853.650037\n16    6177450       8396.0   41803.148624\n17    6184100       7988.0  158712.088621\n18    6201750       7931.0    7774.890016\n19    6178100       7911.0   39385.088725",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_1_gen.csv"
  },
  {
    "prompt": "For 2022, return the top 15 Product_Class_Code by total revenue; tie-break by higher total units, then Product_Class_Code ASC; columns: Product_Class_Code, total_revenue, total_units.",
    "gt_sql": "SELECT Product_Class_Code, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales WHERE CAST(Sold_Date AS VARCHAR) LIKE '2022%' GROUP BY Product_Class_Code ORDER BY total_revenue DESC, total_units DESC, Product_Class_Code ASC LIMIT 15",
    "gt_data": "    Product_Class_Code  total_revenue  total_units\n0                22975   1.135793e+06      64028.0\n1                22800   8.047909e+05      59710.0\n2                24425   7.089950e+05      42726.0\n3                24400   6.123823e+05      43787.0\n4                22850   4.873798e+05      47988.0\n5                22900   4.447206e+05       9750.0\n6                24375   4.390179e+05      13785.0\n7                22875   2.937181e+05      61898.0\n8                22950   1.409884e+05      28590.0\n9                22925   1.197567e+05      16921.0\n10               22825   1.081189e+05      16054.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_2_gt.csv",
    "gen_sql": "SELECT\n    Product_Class_Code,\n    SUM(Total_Sale_Value) AS total_revenue,\n    SUM(Qty_Sold) AS total_units\nFROM\n    sales\nWHERE\n    CAST(Sold_Date AS VARCHAR) LIKE '%2022%'\nGROUP BY\n    Product_Class_Code\nORDER BY\n    total_revenue DESC,\n    total_units DESC,\n    Product_Class_Code ASC\nLIMIT 15;",
    "gen_data": "    Product_Class_Code  total_revenue  total_units\n0                22975   1.135793e+06      64028.0\n1                22800   8.047909e+05      59710.0\n2                24425   7.089950e+05      42726.0\n3                24400   6.123823e+05      43787.0\n4                22850   4.873798e+05      47988.0\n5                22900   4.447206e+05       9750.0\n6                24375   4.390179e+05      13785.0\n7                22875   2.937181e+05      61898.0\n8                22950   1.409884e+05      28590.0\n9                22925   1.197567e+05      16921.0\n10               22825   1.081189e+05      16054.0",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_2_gen.csv"
  },
  {
    "prompt": "For Q1 2023 (2023-01-01 to 2023-03-31), return the top 30 stores by total revenue; tie-break by Store_Number ASC; columns: Store_Number, total_revenue, total_units.",
    "gt_sql": "SELECT Store_Number, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales WHERE Sold_Date >= '2023-01-01' AND Sold_Date <= '2023-03-31' GROUP BY Store_Number ORDER BY total_revenue DESC, Store_Number ASC LIMIT 30",
    "gt_data": "    Store_Number  total_revenue  total_units\n0           2970   76853.159734       5421.0\n1           3300   66626.309749       5318.0\n2           1320   62172.839858       4046.0\n3           1650   56220.139782       4214.0\n4           1100   51486.119914       4098.0\n5           3080   48145.879883       3903.0\n6           1210   43959.729856       3512.0\n7           2420   43363.629744       3883.0\n8           2750   43234.119773       3120.0\n9            880   42863.479745       3534.0\n10          3630   40257.639818       3356.0\n11          2310   38919.459938       2727.0\n12          1540   37388.279729       3087.0\n13           660   37187.619883       2694.0\n14          1870   36756.709768       2846.0\n15          4840   36607.989831       2817.0\n16          3410   36513.879942       2582.0\n17          2090   35334.039831       2924.0\n18          4070   35114.819833       3127.0\n19           330   34503.009759       2814.0\n20           990   34048.199931       2471.0\n21          3740   32873.009876       2274.0\n22          1760   32860.329846       2434.0\n23          2200   31966.259884       2530.0\n24          3190   31134.779882       2401.0\n25           770   29096.689838       2595.0\n26          2640   27016.909833       2143.0\n27          4180   24823.079898       1845.0\n28           550   24038.359882       1928.0\n29          2530   23853.799933       1756.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_3_gt.csv",
    "gen_sql": "SELECT\n    Store_Number,\n    SUM(Total_Sale_Value) AS total_revenue,\n    SUM(Qty_Sold) AS total_units\nFROM\n    sales\nWHERE\n    Sold_Date >= '2023-01-01' AND Sold_Date <= '2023-03-31'\nGROUP BY\n    Store_Number\nORDER BY\n    total_revenue DESC,\n    Store_Number ASC\nLIMIT 30;",
    "gen_data": "    Store_Number  total_revenue  total_units\n0           2970   76853.159734       5421.0\n1           3300   66626.309749       5318.0\n2           1320   62172.839858       4046.0\n3           1650   56220.139782       4214.0\n4           1100   51486.119914       4098.0\n5           3080   48145.879883       3903.0\n6           1210   43959.729856       3512.0\n7           2420   43363.629744       3883.0\n8           2750   43234.119773       3120.0\n9            880   42863.479745       3534.0\n10          3630   40257.639818       3356.0\n11          2310   38919.459938       2727.0\n12          1540   37388.279729       3087.0\n13           660   37187.619883       2694.0\n14          1870   36756.709768       2846.0\n15          4840   36607.989831       2817.0\n16          3410   36513.879942       2582.0\n17          2090   35334.039831       2924.0\n18          4070   35114.819833       3127.0\n19           330   34503.009759       2814.0\n20           990   34048.199931       2471.0\n21          3740   32873.009876       2274.0\n22          1760   32860.329846       2434.0\n23          2200   31966.259884       2530.0\n24          3190   31134.779882       2401.0\n25           770   29096.689838       2595.0\n26          2640   27016.909833       2143.0\n27          4180   24823.079898       1845.0\n28           550   24038.359882       1928.0\n29          2530   23853.799933       1756.0",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_3_gen.csv"
  },
  {
    "prompt": "For 2023, return the top 10 SKUs by total revenue and include the average price per unit; columns: SKU_Coded, total_revenue, total_units, avg_unit_price; compute the avg_unit_price with sum(Total_Sale_Value)/sum(Qty_Sold) don't use the AVG function.",
    "gt_sql": "SELECT SKU_Coded, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units, SUM(Total_Sale_Value) / SUM(Qty_Sold) AS avg_unit_price FROM sales WHERE CAST(Sold_Date AS VARCHAR) LIKE '2023%' GROUP BY SKU_Coded ORDER BY total_revenue DESC, SKU_Coded ASC LIMIT 10",
    "gt_data": "   SKU_Coded  total_revenue  total_units  avg_unit_price\n0    6200700  353964.937498      36081.0        9.810286\n1    6184900  147797.616945       1651.0       89.520059\n2    6194250  116109.579178       5824.0       19.936398\n3    6200650   83765.828704       8405.0        9.966190\n4    6191400   70791.602219       1581.0       44.776472\n5    6184100   67589.119407       3396.0       19.902568\n6    6186250   66756.588099        960.0       69.538113\n7    6176200   60119.691723       1086.0       55.358832\n8    6199250   57957.061886       1273.0       45.527935\n9    6179250   54660.029366       3675.0       14.873477",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_4_gt.csv",
    "gen_sql": "SELECT SKU_Coded,\n       SUM(Total_Sale_Value) AS total_revenue,\n       SUM(Qty_Sold) AS total_units,\n       SUM(Total_Sale_Value)/SUM(Qty_Sold) AS avg_unit_price\nFROM sales\nWHERE CAST(Sold_Date AS VARCHAR) LIKE '%2023%'\nGROUP BY SKU_Coded\nORDER BY total_revenue DESC\nLIMIT 10;",
    "gen_data": "   SKU_Coded  total_revenue  total_units  avg_unit_price\n0    6200700  353964.937498      36081.0        9.810286\n1    6184900  147797.616945       1651.0       89.520059\n2    6194250  116109.579178       5824.0       19.936398\n3    6200650   83765.828704       8405.0        9.966190\n4    6191400   70791.602219       1581.0       44.776472\n5    6184100   67589.119407       3396.0       19.902568\n6    6186250   66756.588099        960.0       69.538113\n7    6176200   60119.691723       1086.0       55.358832\n8    6199250   57957.061886       1273.0       45.527935\n9    6179250   54660.029366       3675.0       14.873477",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_4_gen.csv"
  },
  {
    "prompt": "For 2023, return the top 50 stores by distinct SKUs sold; tie-break by Store_Number ASC; columns: Store_Number, distinct_skus.",
    "gt_sql": "SELECT Store_Number, COUNT(DISTINCT SKU_Coded) AS distinct_skus FROM sales WHERE CAST(Sold_Date AS VARCHAR) LIKE '2023%' GROUP BY Store_Number ORDER BY distinct_skus DESC, Store_Number ASC LIMIT 50",
    "gt_data": "    Store_Number  distinct_skus\n0           2640            453\n1           1320            449\n2           3300            448\n3            990            447\n4           1540            447\n5           2310            446\n6           2970            446\n7           2090            444\n8           3190            443\n9           3410            443\n10          3630            443\n11          4840            443\n12          1650            441\n13          2420            441\n14          4070            440\n15          4180            438\n16          1100            437\n17          4730            437\n18          2200            436\n19          2530            436\n20          2750            435\n21          3080            434\n22          3740            433\n23          1870            429\n24          1980            428\n25          1760            427\n26          2860            427\n27          3520            427\n28          1210            420\n29           880            402\n30           660            398\n31           330            391\n32           770            387\n33           550            379\n34          4400            245",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_5_gt.csv",
    "gen_sql": "SELECT Store_Number, COUNT(DISTINCT SKU_Coded) AS distinct_skus\nFROM sales\nWHERE CAST(Sold_Date AS VARCHAR) LIKE '%2023%'\nGROUP BY Store_Number\nORDER BY COUNT(DISTINCT SKU_Coded) DESC, Store_Number ASC\nLIMIT 50;",
    "gen_data": "    Store_Number  distinct_skus\n0           2640            453\n1           1320            449\n2           3300            448\n3            990            447\n4           1540            447\n5           2310            446\n6           2970            446\n7           2090            444\n8           3190            443\n9           3410            443\n10          3630            443\n11          4840            443\n12          1650            441\n13          2420            441\n14          4070            440\n15          4180            438\n16          1100            437\n17          4730            437\n18          2200            436\n19          2530            436\n20          2750            435\n21          3080            434\n22          3740            433\n23          1870            429\n24          1980            428\n25          1760            427\n26          2860            427\n27          3520            427\n28          1210            420\n29           880            402\n30           660            398\n31           330            391\n32           770            387\n33           550            379\n34          4400            245",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_5_gen.csv"
  },
  {
    "prompt": "Across the full dataset, return the 40 SKUs with the highest average unit price among SKUs with at least 50 units sold; avg_unit_price = sum(Total_Sale_Value)/sum(Qty_Sold) don't use the AVG function; tie-break by SKU_Coded ASC; columns: SKU_Coded, avg_unit_price, total_units, total_revenue.",
    "gt_sql": "SELECT SKU_Coded, SUM(Total_Sale_Value) / SUM(Qty_Sold) AS avg_unit_price, SUM(Qty_Sold) AS total_units, SUM(Total_Sale_Value) AS total_revenue FROM sales GROUP BY SKU_Coded HAVING SUM(Qty_Sold) >= 50 ORDER BY avg_unit_price DESC, SKU_Coded ASC LIMIT 40",
    "gt_data": "    SKU_Coded  avg_unit_price  total_units  total_revenue\n0     6204850      148.910149        415.0   61797.711670\n1     6204800      113.203668        540.0   61129.980629\n2     6185100       99.552126       1330.0  132404.327278\n3     6195750       89.929595        149.0   13399.509682\n4     6184900       89.549110       3817.0  341808.952810\n5     6179650       85.405995        607.0   51841.438976\n6     6202800       79.963331        150.0   11994.499710\n7     6202350       79.673314        585.0   46608.888786\n8     6197600       79.662474        961.0   76555.637985\n9     6202500       78.955015        297.0   23449.639423\n10    6186250       69.497521       2358.0  163875.155296\n11    6203450       69.229686         96.0    6646.049843\n12    6198500       68.905880        391.0   26942.199215\n13    6195250       60.477207        569.0   34411.530737\n14    6185150       59.722789        427.0   25501.630703\n15    6202900       59.095934        177.0   10459.980293\n16    6196350       58.232667        619.0   36046.020971\n17    6176250       55.351915       2645.0  146405.814148\n18    6176200       55.336678       2702.0  149519.704277\n19    6192500       54.697923       1352.0   73951.592205\n20    6196200       54.198661       1366.0   74035.371582\n21    6197000       53.483860        101.0    5401.869850\n22    6179600       49.800600       2090.0  104083.253410\n23    6187700       49.601256        255.0   12648.320265\n24    6190450       49.551977       2136.0  105843.023338\n25    6200000       49.547903        672.0   33296.191074\n26    6198550       49.532701        426.0   21100.930643\n27    6199050       49.468417        694.0   34331.081085\n28    6190500       49.447309       1196.0   59138.981873\n29    6193250       48.936241        484.0   23685.140501\n30    6196550       48.301811       1039.0   50185.581646\n31    6191400       46.821826       5657.0  264871.067286\n32    6199300       46.615198       1828.0   85212.582848\n33    6193200       46.034189       2627.0  120931.813671\n34    6199150       45.887521       1532.0   70299.682259\n35    6199250       45.613453       2341.0  106781.093248\n36    6188750       45.345383        301.0   13648.960375\n37    6199100       44.724452        910.0   40699.251480\n38    6200550       44.461141        518.0   23030.870823\n39    6196500       43.588645        531.0   23145.570544",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_6_gt.csv",
    "gen_sql": "SELECT\n    SKU_Coded,\n    SUM(Total_Sale_Value) / SUM(Qty_Sold) AS avg_unit_price,\n    SUM(Qty_Sold) AS total_units,\n    SUM(Total_Sale_Value) AS total_revenue\nFROM\n    sales\nGROUP BY\n    SKU_Coded\nHAVING\n    SUM(Qty_Sold) >= 50\nORDER BY\n    avg_unit_price DESC,\n    SKU_Coded ASC\nLIMIT 40;",
    "gen_data": "    SKU_Coded  avg_unit_price  total_units  total_revenue\n0     6204850      148.910149        415.0   61797.711670\n1     6204800      113.203668        540.0   61129.980629\n2     6185100       99.552126       1330.0  132404.327278\n3     6195750       89.929595        149.0   13399.509682\n4     6184900       89.549110       3817.0  341808.952810\n5     6179650       85.405995        607.0   51841.438976\n6     6202800       79.963331        150.0   11994.499710\n7     6202350       79.673314        585.0   46608.888786\n8     6197600       79.662474        961.0   76555.637985\n9     6202500       78.955015        297.0   23449.639423\n10    6186250       69.497521       2358.0  163875.155296\n11    6203450       69.229686         96.0    6646.049843\n12    6198500       68.905880        391.0   26942.199215\n13    6195250       60.477207        569.0   34411.530737\n14    6185150       59.722789        427.0   25501.630703\n15    6202900       59.095934        177.0   10459.980293\n16    6196350       58.232667        619.0   36046.020971\n17    6176250       55.351915       2645.0  146405.814148\n18    6176200       55.336678       2702.0  149519.704277\n19    6192500       54.697923       1352.0   73951.592205\n20    6196200       54.198661       1366.0   74035.371582\n21    6197000       53.483860        101.0    5401.869850\n22    6179600       49.800600       2090.0  104083.253410\n23    6187700       49.601256        255.0   12648.320265\n24    6190450       49.551977       2136.0  105843.023338\n25    6200000       49.547903        672.0   33296.191074\n26    6198550       49.532701        426.0   21100.930643\n27    6199050       49.468417        694.0   34331.081085\n28    6190500       49.447309       1196.0   59138.981873\n29    6193250       48.936241        484.0   23685.140501\n30    6196550       48.301811       1039.0   50185.581646\n31    6191400       46.821826       5657.0  264871.067286\n32    6199300       46.615198       1828.0   85212.582848\n33    6193200       46.034189       2627.0  120931.813671\n34    6199150       45.887521       1532.0   70299.682259\n35    6199250       45.613453       2341.0  106781.093248\n36    6188750       45.345383        301.0   13648.960375\n37    6199100       44.724452        910.0   40699.251480\n38    6200550       44.461141        518.0   23030.870823\n39    6196500       43.588645        531.0   23145.570544",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_6_gen.csv"
  },
  {
    "prompt": "Return the 30 most recent Sold_Date values aggregated by date with columns: Sold_Date, total_revenue, total_units; order by Sold_Date DESC.",
    "gt_sql": "SELECT Sold_Date, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales GROUP BY Sold_Date ORDER BY Sold_Date DESC LIMIT 30",
    "gt_data": "    Sold_Date  total_revenue  total_units\n0  2024-03-31   11465.159956        865.0\n1  2024-03-30   12130.429914       1043.0\n2  2024-03-29   18130.919942       1446.0\n3  2024-03-28   12410.239968       1033.0\n4  2024-03-27    9486.669932        797.0\n5  2024-03-26    8913.299928        808.0\n6  2024-03-25    9394.489947        814.0\n7  2024-03-24   11490.389904        973.0\n8  2024-03-22   14739.649938       1310.0\n9  2024-03-21   12593.679940       1017.0\n10 2024-03-20   10035.429957        723.0\n11 2024-03-19    9781.329939        779.0\n12 2024-03-18    8151.019921        759.0\n13 2024-03-17    8685.079932        723.0\n14 2024-03-16   12654.869916       1019.0\n15 2024-03-15   16860.119913       1341.0\n16 2024-03-14   12704.229942       1104.0\n17 2024-03-13   10113.479960        731.0\n18 2024-03-12    9319.179927        743.0\n19 2024-03-11    9057.659943        718.0\n20 2024-03-10   10858.899962        816.0\n21 2024-03-09   12723.899937       1012.0\n22 2024-03-08   18448.579874       1541.0\n23 2024-03-07   12583.609902       1029.0\n24 2024-03-06   10497.679946        803.0\n25 2024-03-05    9982.559910        730.0\n26 2024-03-04    9461.179928        766.0\n27 2024-03-03   11190.739941        941.0\n28 2024-03-02   13834.259921       1101.0\n29 2024-03-01   16214.309858       1499.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_7_gt.csv",
    "gen_sql": "SELECT CAST(Sold_Date AS DATE) AS Sold_Date,\n       SUM(Total_Sale_Value) AS total_revenue,\n       SUM(Qty_Sold) AS total_units\nFROM sales\nGROUP BY CAST(Sold_Date AS DATE)\nORDER BY Sold_Date DESC\nLIMIT 30;",
    "gen_data": "    Sold_Date  total_revenue  total_units\n0  2024-03-31   11465.159956        865.0\n1  2024-03-30   12130.429914       1043.0\n2  2024-03-29   18130.919942       1446.0\n3  2024-03-28   12410.239968       1033.0\n4  2024-03-27    9486.669932        797.0\n5  2024-03-26    8913.299928        808.0\n6  2024-03-25    9394.489947        814.0\n7  2024-03-24   11490.389904        973.0\n8  2024-03-22   14739.649938       1310.0\n9  2024-03-21   12593.679940       1017.0\n10 2024-03-20   10035.429957        723.0\n11 2024-03-19    9781.329939        779.0\n12 2024-03-18    8151.019921        759.0\n13 2024-03-17    8685.079932        723.0\n14 2024-03-16   12654.869916       1019.0\n15 2024-03-15   16860.119913       1341.0\n16 2024-03-14   12704.229942       1104.0\n17 2024-03-13   10113.479960        731.0\n18 2024-03-12    9319.179927        743.0\n19 2024-03-11    9057.659943        718.0\n20 2024-03-10   10858.899962        816.0\n21 2024-03-09   12723.899937       1012.0\n22 2024-03-08   18448.579874       1541.0\n23 2024-03-07   12583.609902       1029.0\n24 2024-03-06   10497.679946        803.0\n25 2024-03-05    9982.559910        730.0\n26 2024-03-04    9461.179928        766.0\n27 2024-03-03   11190.739941        941.0\n28 2024-03-02   13834.259921       1101.0\n29 2024-03-01   16214.309858       1499.0",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_7_gen.csv"
  },
  {
    "prompt": "For 2022, return the top 25 stores by total units sold for Product_Class_Code = 22975; tie-break by Store_Number ASC; columns: Store_Number, total_units, total_revenue.",
    "gt_sql": "SELECT Store_Number, SUM(Qty_Sold) AS total_units, SUM(Total_Sale_Value) AS total_revenue FROM sales WHERE Product_Class_Code = 22975 AND CAST(Sold_Date AS VARCHAR) LIKE '2022%' GROUP BY Store_Number ORDER BY total_units DESC, Store_Number ASC LIMIT 25",
    "gt_data": "    Store_Number  total_units  total_revenue\n0           2970       4061.0   67735.229967\n1           3080       3201.0   47103.769739\n2           1210       3179.0   53590.399891\n3           1650       2889.0   51583.809919\n4           3300       2872.0   52745.349853\n5           1100       2748.0   44162.889747\n6           1320       2506.0   50930.190013\n7           2750       2399.0   41942.669923\n8           2420       2239.0   41258.299958\n9           2200       2111.0   39076.459951\n10          2310       2019.0   36246.150019\n11           990       2012.0   41125.950106\n12           880       2005.0   38132.759994\n13          3410       1938.0   33407.269839\n14           330       1913.0   33351.169944\n15           660       1909.0   35899.000001\n16          3630       1898.0   34752.339867\n17          1540       1775.0   30341.179863\n18          1870       1758.0   32101.399936\n19          4840       1744.0   28351.719901\n20          3740       1739.0   30222.319891\n21          2090       1599.0   26344.379813\n22          4070       1576.0   29304.379972\n23          1760       1559.0   30691.659863\n24          3190       1543.0   26704.299887",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_8_gt.csv",
    "gen_sql": "SELECT Store_Number,\n       SUM(Qty_Sold) AS total_units,\n       SUM(Total_Sale_Value) AS total_revenue\nFROM sales\nWHERE Product_Class_Code = 22975\n  AND CAST(Sold_Date AS VARCHAR) LIKE '%2022%'\nGROUP BY Store_Number\nORDER BY total_units DESC, Store_Number ASC\nLIMIT 25;",
    "gen_data": "    Store_Number  total_units  total_revenue\n0           2970       4061.0   67735.229967\n1           3080       3201.0   47103.769739\n2           1210       3179.0   53590.399891\n3           1650       2889.0   51583.809919\n4           3300       2872.0   52745.349853\n5           1100       2748.0   44162.889747\n6           1320       2506.0   50930.190013\n7           2750       2399.0   41942.669923\n8           2420       2239.0   41258.299958\n9           2200       2111.0   39076.459951\n10          2310       2019.0   36246.150019\n11           990       2012.0   41125.950106\n12           880       2005.0   38132.759994\n13          3410       1938.0   33407.269839\n14           330       1913.0   33351.169944\n15           660       1909.0   35899.000001\n16          3630       1898.0   34752.339867\n17          1540       1775.0   30341.179863\n18          1870       1758.0   32101.399936\n19          4840       1744.0   28351.719901\n20          3740       1739.0   30222.319891\n21          2090       1599.0   26344.379813\n22          4070       1576.0   29304.379972\n23          1760       1559.0   30691.659863\n24          3190       1543.0   26704.299887",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_8_gen.csv"
  },
  {
    "prompt": "Return the 12 months of 2023 with total revenue and total units sold; order by month_start ASC.",
    "gt_sql": "SELECT DATE_TRUNC('month', Sold_Date), sum(Total_Sale_Value), sum(Qty_Sold) FROM sales WHERE YEAR(Sold_Date) = 2023 GROUP BY DATE_TRUNC('month', Sold_Date) ORDER BY DATE_TRUNC('month', Sold_Date) ASC",
    "gt_data": "   date_trunc('month', Sold_Date)  sum(Total_Sale_Value)  sum(Qty_Sold)\n0                      2023-01-01          434172.808300        33653.0\n1                      2023-02-01          411762.718244        31545.0\n2                      2023-03-01          423070.838309        32460.0\n3                      2023-04-01          384479.678311        30199.0\n4                      2023-05-01          381326.428023        31154.0\n5                      2023-06-01          364806.737856        29082.0\n6                      2023-07-01          353284.207838        27932.0\n7                      2023-08-01          401061.537729        31903.0\n8                      2023-09-01          422554.967469        31847.0\n9                      2023-10-01          454231.057104        38208.0\n10                     2023-11-01          511104.287418        41043.0\n11                     2023-12-01          874263.668331        60941.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_9_gt.csv",
    "gen_sql": "SELECT DATE_TRUNC('month', Sold_Date) AS month_start,\n       SUM(Total_Sale_Value) AS total_revenue,\n       SUM(Qty_Sold) AS total_units_sold\nFROM sales\nWHERE CAST(Sold_Date AS VARCHAR) LIKE '2023%'\nGROUP BY month_start\nORDER BY month_start ASC;",
    "gen_data": "   month_start  total_revenue  total_units_sold\n0   2023-01-01  434172.808300           33653.0\n1   2023-02-01  411762.718244           31545.0\n2   2023-03-01  423070.838309           32460.0\n3   2023-04-01  384479.678311           30199.0\n4   2023-05-01  381326.428023           31154.0\n5   2023-06-01  364806.737856           29082.0\n6   2023-07-01  353284.207838           27932.0\n7   2023-08-01  401061.537729           31903.0\n8   2023-09-01  422554.967469           31847.0\n9   2023-10-01  454231.057104           38208.0\n10  2023-11-01  511104.287418           41043.0\n11  2023-12-01  874263.668331           60941.0",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_9_gen.csv"
  },
  {
    "prompt": "Return the top 20 SKUs by total units sold across the full dataset; tie-break by higher total revenue, then SKU_Coded ASC.",
    "gt_sql": "SELECT SKU_Coded, sum(Qty_Sold), sum(Total_Sale_Value) FROM sales GROUP BY SKU_Coded ORDER BY sum(Qty_Sold) DESC, sum(Total_Sale_Value) DESC, SKU_Coded ASC LIMIT 20",
    "gt_data": "    SKU_Coded  sum(Qty_Sold)  sum(Total_Sale_Value)\n0     6200700        52262.0          515088.125879\n1     6194250        14905.0          296872.717907\n2     6193800        13744.0          102779.887266\n3     6177750        12982.0           24268.139672\n4     6177350        12702.0          107732.197505\n5     6200650        12599.0          125459.188012\n6     6187750        11909.0           94285.607714\n7     6191100        11750.0           93128.078166\n8     6190100        11293.0           14756.900020\n9     6200800        10577.0           25954.219908\n10    6179250         9731.0          145054.308485\n11    6179200         9411.0           52888.138254\n12    6192300         8845.0           35013.700175\n13    6195800         8676.0           84304.989587\n14    6182050         8539.0           67969.048205\n15    6173350         8419.0           73853.650037\n16    6177450         8396.0           41803.148624\n17    6184100         7988.0          158712.088621\n18    6201750         7931.0            7774.890016\n19    6178100         7911.0           39385.088725",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_10_gt.csv",
    "gen_sql": "SELECT\n    SKU_Coded,\n    SUM(Qty_Sold) AS total_units,\n    SUM(Total_Sale_Value) AS total_revenue\nFROM\n    sales\nGROUP BY\n    SKU_Coded\nORDER BY\n    total_units DESC,\n    total_revenue DESC,\n    SKU_Coded ASC\nLIMIT 20;",
    "gen_data": "    SKU_Coded  total_units  total_revenue\n0     6200700      52262.0  515088.125879\n1     6194250      14905.0  296872.717907\n2     6193800      13744.0  102779.887266\n3     6177750      12982.0   24268.139672\n4     6177350      12702.0  107732.197505\n5     6200650      12599.0  125459.188012\n6     6187750      11909.0   94285.607714\n7     6191100      11750.0   93128.078166\n8     6190100      11293.0   14756.900020\n9     6200800      10577.0   25954.219908\n10    6179250       9731.0  145054.308485\n11    6179200       9411.0   52888.138254\n12    6192300       8845.0   35013.700175\n13    6195800       8676.0   84304.989587\n14    6182050       8539.0   67969.048205\n15    6173350       8419.0   73853.650037\n16    6177450       8396.0   41803.148624\n17    6184100       7988.0  158712.088621\n18    6201750       7931.0    7774.890016\n19    6178100       7911.0   39385.088725",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_10_gen.csv"
  },
  {
    "prompt": "For 2022, return the top 15 Product_Class_Code by total revenue; tie-break by higher total units, then Product_Class_Code ASC.",
    "gt_sql": "SELECT Product_Class_Code, sum(Total_Sale_Value), sum(Qty_Sold) FROM sales WHERE YEAR(Sold_Date) = 2022 GROUP BY Product_Class_Code ORDER BY sum(Total_Sale_Value) DESC, sum(Qty_Sold) DESC, Product_Class_Code ASC LIMIT 15",
    "gt_data": "    Product_Class_Code  sum(Total_Sale_Value)  sum(Qty_Sold)\n0                22975           1.135793e+06        64028.0\n1                22800           8.047909e+05        59710.0\n2                24425           7.089950e+05        42726.0\n3                24400           6.123823e+05        43787.0\n4                22850           4.873798e+05        47988.0\n5                22900           4.447206e+05         9750.0\n6                24375           4.390179e+05        13785.0\n7                22875           2.937181e+05        61898.0\n8                22950           1.409884e+05        28590.0\n9                22925           1.197567e+05        16921.0\n10               22825           1.081189e+05        16054.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_11_gt.csv",
    "gen_sql": "SELECT\n    Product_Class_Code,\n    SUM(Total_Sale_Value) AS total_revenue,\n    SUM(Qty_Sold) AS total_units\nFROM\n    sales\nWHERE\n    CAST(Sold_Date AS VARCHAR) LIKE '%2022%'\nGROUP BY\n    Product_Class_Code\nORDER BY\n    total_revenue DESC,\n    total_units DESC,\n    Product_Class_Code ASC\nLIMIT 15;",
    "gen_data": "    Product_Class_Code  total_revenue  total_units\n0                22975   1.135793e+06      64028.0\n1                22800   8.047909e+05      59710.0\n2                24425   7.089950e+05      42726.0\n3                24400   6.123823e+05      43787.0\n4                22850   4.873798e+05      47988.0\n5                22900   4.447206e+05       9750.0\n6                24375   4.390179e+05      13785.0\n7                22875   2.937181e+05      61898.0\n8                22950   1.409884e+05      28590.0\n9                22925   1.197567e+05      16921.0\n10               22825   1.081189e+05      16054.0",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_11_gen.csv"
  },
  {
    "prompt": "For 2023, return the top 25 stores by promotional unit share (promo_units/total_units) among stores with at least 100 total units; tie-break by Store_Number ASC.",
    "gt_sql": "SELECT Store_Number, sum(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END) * 1.0 / sum(Qty_Sold), sum(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END), sum(Qty_Sold) FROM sales WHERE YEAR(Sold_Date) = 2023 GROUP BY Store_Number HAVING sum(Qty_Sold) >= 100 ORDER BY sum(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END) * 1.0 / sum(Qty_Sold) DESC, Store_Number ASC LIMIT 25",
    "gt_data": "    Store_Number  ((sum(CASE  WHEN ((On_Promo = 1)) THEN (Qty_Sold) ELSE 0 END) * 1.0) / sum(Qty_Sold))  sum(CASE  WHEN ((On_Promo = 1)) THEN (Qty_Sold) ELSE 0 END)  sum(Qty_Sold)\n0           2860                                                                               0.034158                                                        250.0         7319.0\n1           3190                                                                               0.031972                                                        360.0        11260.0\n2            770                                                                               0.030119                                                        312.0        10359.0\n3           1980                                                                               0.026000                                                        223.0         8577.0\n4           1540                                                                               0.024591                                                        299.0        12159.0\n5           2640                                                                               0.023646                                                        290.0        12264.0\n6           2090                                                                               0.022339                                                        230.0        10296.0\n7            990                                                                               0.022317                                                        252.0        11292.0\n8           3520                                                                               0.020542                                                        144.0         7010.0\n9           4180                                                                               0.020420                                                        173.0         8472.0\n10          4070                                                                               0.019401                                                        235.0        12113.0\n11          3740                                                                               0.019384                                                        212.0        10937.0\n12          2420                                                                               0.018709                                                        284.0        15180.0\n13          2530                                                                               0.017813                                                        179.0        10049.0\n14          4730                                                                               0.015883                                                        122.0         7681.0\n15          1100                                                                               0.015381                                                        243.0        15799.0\n16          2310                                                                               0.015083                                                        186.0        12332.0\n17          3630                                                                               0.014586                                                        206.0        14123.0\n18          3080                                                                               0.014562                                                        195.0        13391.0\n19          2200                                                                               0.014395                                                        141.0         9795.0\n20          1870                                                                               0.013401                                                        150.0        11193.0\n21          2750                                                                               0.013273                                                        184.0        13863.0\n22          4840                                                                               0.012128                                                        142.0        11708.0\n23          1320                                                                               0.012087                                                        235.0        19443.0\n24           330                                                                               0.011786                                                        140.0        11879.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_12_gt.csv",
    "gen_sql": "SELECT\n    Store_Number,\n    SUM(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END) AS promo_units,\n    SUM(Qty_Sold) AS total_units,\n    SUM(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END) * 1.0 / SUM(Qty_Sold) AS promo_share\nFROM sales\nWHERE CAST(Sold_Date AS VARCHAR) LIKE '%2023%'\nGROUP BY Store_Number\nHAVING SUM(Qty_Sold) >= 100\nORDER BY promo_share DESC, Store_Number ASC\nLIMIT 25;",
    "gen_data": "    Store_Number  promo_units  total_units  promo_share\n0           2860        250.0       7319.0     0.034158\n1           3190        360.0      11260.0     0.031972\n2            770        312.0      10359.0     0.030119\n3           1980        223.0       8577.0     0.026000\n4           1540        299.0      12159.0     0.024591\n5           2640        290.0      12264.0     0.023646\n6           2090        230.0      10296.0     0.022339\n7            990        252.0      11292.0     0.022317\n8           3520        144.0       7010.0     0.020542\n9           4180        173.0       8472.0     0.020420\n10          4070        235.0      12113.0     0.019401\n11          3740        212.0      10937.0     0.019384\n12          2420        284.0      15180.0     0.018709\n13          2530        179.0      10049.0     0.017813\n14          4730        122.0       7681.0     0.015883\n15          1100        243.0      15799.0     0.015381\n16          2310        186.0      12332.0     0.015083\n17          3630        206.0      14123.0     0.014586\n18          3080        195.0      13391.0     0.014562\n19          2200        141.0       9795.0     0.014395\n20          1870        150.0      11193.0     0.013401\n21          2750        184.0      13863.0     0.013273\n22          4840        142.0      11708.0     0.012128\n23          1320        235.0      19443.0     0.012087\n24           330        140.0      11879.0     0.011786",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_12_gen.csv"
  },
  {
    "prompt": "For Q1 2023 (2023-01-01 to 2023-03-31), return the top 30 stores by total revenue; tie-break by Store_Number ASC.",
    "gt_sql": "SELECT Store_Number, sum(Total_Sale_Value), sum(Qty_Sold) FROM sales WHERE Sold_Date >= '2023-01-01' AND Sold_Date <= '2023-03-31' GROUP BY Store_Number ORDER BY sum(Total_Sale_Value) DESC, Store_Number ASC LIMIT 30",
    "gt_data": "    Store_Number  sum(Total_Sale_Value)  sum(Qty_Sold)\n0           2970           76853.159734         5421.0\n1           3300           66626.309749         5318.0\n2           1320           62172.839858         4046.0\n3           1650           56220.139782         4214.0\n4           1100           51486.119914         4098.0\n5           3080           48145.879883         3903.0\n6           1210           43959.729856         3512.0\n7           2420           43363.629744         3883.0\n8           2750           43234.119773         3120.0\n9            880           42863.479745         3534.0\n10          3630           40257.639818         3356.0\n11          2310           38919.459938         2727.0\n12          1540           37388.279729         3087.0\n13           660           37187.619883         2694.0\n14          1870           36756.709768         2846.0\n15          4840           36607.989831         2817.0\n16          3410           36513.879942         2582.0\n17          2090           35334.039831         2924.0\n18          4070           35114.819833         3127.0\n19           330           34503.009759         2814.0\n20           990           34048.199931         2471.0\n21          3740           32873.009876         2274.0\n22          1760           32860.329846         2434.0\n23          2200           31966.259884         2530.0\n24          3190           31134.779882         2401.0\n25           770           29096.689838         2595.0\n26          2640           27016.909833         2143.0\n27          4180           24823.079898         1845.0\n28           550           24038.359882         1928.0\n29          2530           23853.799933         1756.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_13_gt.csv",
    "gen_sql": "SELECT Store_Number, SUM(Total_Sale_Value) AS Total_Revenue\nFROM sales\nWHERE Sold_Date >= '2023-01-01' AND Sold_Date <= '2023-03-31'\nGROUP BY Store_Number\nORDER BY Total_Revenue DESC, Store_Number ASC\nLIMIT 30;",
    "gen_data": "    Store_Number  Total_Revenue\n0           2970   76853.159734\n1           3300   66626.309749\n2           1320   62172.839858\n3           1650   56220.139782\n4           1100   51486.119914\n5           3080   48145.879883\n6           1210   43959.729856\n7           2420   43363.629744\n8           2750   43234.119773\n9            880   42863.479745\n10          3630   40257.639818\n11          2310   38919.459938\n12          1540   37388.279729\n13           660   37187.619883\n14          1870   36756.709768\n15          4840   36607.989831\n16          3410   36513.879942\n17          2090   35334.039831\n18          4070   35114.819833\n19           330   34503.009759\n20           990   34048.199931\n21          3740   32873.009876\n22          1760   32860.329846\n23          2200   31966.259884\n24          3190   31134.779882\n25           770   29096.689838\n26          2640   27016.909833\n27          4180   24823.079898\n28           550   24038.359882\n29          2530   23853.799933",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_13_gen.csv"
  },
  {
    "prompt": "For 2023, return the top 10 SKUs by total revenue with avg unit price = sum(Total_Sale_Value)/sum(Qty_Sold); tie-break by SKU_Coded ASC.",
    "gt_sql": "SELECT SKU_Coded, sum(Total_Sale_Value), sum(Qty_Sold), sum(Total_Sale_Value) / sum(Qty_Sold) FROM sales WHERE YEAR(Sold_Date) = 2023 GROUP BY SKU_Coded ORDER BY sum(Total_Sale_Value) DESC, SKU_Coded ASC LIMIT 10",
    "gt_data": "   SKU_Coded  sum(Total_Sale_Value)  sum(Qty_Sold)  (sum(Total_Sale_Value) / sum(Qty_Sold))\n0    6200700          353964.937498        36081.0                                 9.810286\n1    6184900          147797.616945         1651.0                                89.520059\n2    6194250          116109.579178         5824.0                                19.936398\n3    6200650           83765.828704         8405.0                                 9.966190\n4    6191400           70791.602219         1581.0                                44.776472\n5    6184100           67589.119407         3396.0                                19.902568\n6    6186250           66756.588099          960.0                                69.538113\n7    6176200           60119.691723         1086.0                                55.358832\n8    6199250           57957.061886         1273.0                                45.527935\n9    6179250           54660.029366         3675.0                                14.873477",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_14_gt.csv",
    "gen_sql": "SELECT\n    SKU_Coded,\n    SUM(Total_Sale_Value) AS Total_Revenue,\n    SUM(Total_Sale_Value) / SUM(Qty_Sold) AS Avg_Unit_Price\nFROM\n    sales\nWHERE\n    CAST(Sold_Date AS VARCHAR) LIKE '%2023%'\nGROUP BY\n    SKU_Coded\nORDER BY\n    SUM(Total_Sale_Value) DESC,\n    SKU_Coded ASC\nLIMIT 10;",
    "gen_data": "   SKU_Coded  Total_Revenue  Avg_Unit_Price\n0    6200700  353964.937498        9.810286\n1    6184900  147797.616945       89.520059\n2    6194250  116109.579178       19.936398\n3    6200650   83765.828704        9.966190\n4    6191400   70791.602219       44.776472\n5    6184100   67589.119407       19.902568\n6    6186250   66756.588099       69.538113\n7    6176200   60119.691723       55.358832\n8    6199250   57957.061886       45.527935\n9    6179250   54660.029366       14.873477",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_14_gen.csv"
  },
  {
    "prompt": "For 2023, return month-by-promo aggregates; order by month_start ASC, On_Promo ASC; expect 24 rows.",
    "gt_sql": "SELECT DATE_TRUNC('month', Sold_Date), On_Promo, sum(Total_Sale_Value), sum(Qty_Sold) FROM sales WHERE YEAR(Sold_Date) = 2023 GROUP BY DATE_TRUNC('month', Sold_Date), On_Promo ORDER BY DATE_TRUNC('month', Sold_Date) ASC, On_Promo ASC",
    "gt_data": "   date_trunc('month', Sold_Date)  On_Promo  sum(Total_Sale_Value)  sum(Qty_Sold)\n0                      2023-01-01         0          434102.828296        33651.0\n1                      2023-01-01         1              69.980003            2.0\n2                      2023-02-01         0          411762.718244        31545.0\n3                      2023-03-01         0          423070.838309        32460.0\n4                      2023-04-01         0          378326.478314        29351.0\n5                      2023-04-01         1            6153.199997          848.0\n6                      2023-05-01         0          379860.538039        30943.0\n7                      2023-05-01         1            1465.889984          211.0\n8                      2023-06-01         0          364806.737856        29082.0\n9                      2023-07-01         0          353284.207838        27932.0\n10                     2023-08-01         0          398592.447746        31612.0\n11                     2023-08-01         1            2469.089983          291.0\n12                     2023-09-01         0          415126.857461        31789.0\n13                     2023-09-01         1            7428.110008           58.0\n14                     2023-10-01         0          446184.807069        36423.0\n15                     2023-10-01         1            8046.250035         1785.0\n16                     2023-11-01         0          476004.377225        39141.0\n17                     2023-11-01         1           35099.910192         1902.0\n18                     2023-12-01         0          835289.237587        59511.0\n19                     2023-12-01         1           38974.430744         1430.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_15_gt.csv",
    "gen_sql": "SELECT\n    DATE_TRUNC('month', Sold_Date) AS month_start,\n    On_Promo,\n    SUM(Qty_Sold) AS total_qty,\n    SUM(Total_Sale_Value) AS total_sales\nFROM\n    sales\nWHERE\n    CAST(Sold_Date AS VARCHAR) LIKE '2023-%'\nGROUP BY\n    month_start,\n    On_Promo\nORDER BY\n    month_start ASC,\n    On_Promo ASC;",
    "gen_data": "   month_start  On_Promo  total_qty    total_sales\n0   2023-01-01         0    33651.0  434102.828296\n1   2023-01-01         1        2.0      69.980003\n2   2023-02-01         0    31545.0  411762.718244\n3   2023-03-01         0    32460.0  423070.838309\n4   2023-04-01         0    29351.0  378326.478314\n5   2023-04-01         1      848.0    6153.199997\n6   2023-05-01         0    30943.0  379860.538039\n7   2023-05-01         1      211.0    1465.889984\n8   2023-06-01         0    29082.0  364806.737856\n9   2023-07-01         0    27932.0  353284.207838\n10  2023-08-01         0    31612.0  398592.447746\n11  2023-08-01         1      291.0    2469.089983\n12  2023-09-01         0    31789.0  415126.857461\n13  2023-09-01         1       58.0    7428.110008\n14  2023-10-01         0    36423.0  446184.807069\n15  2023-10-01         1     1785.0    8046.250035\n16  2023-11-01         0    39141.0  476004.377225\n17  2023-11-01         1     1902.0   35099.910192\n18  2023-12-01         0    59511.0  835289.237587\n19  2023-12-01         1     1430.0   38974.430744",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_15_gen.csv"
  },
  {
    "prompt": "For 2023, return the top 50 stores by distinct SKUs sold; tie-break by Store_Number ASC.",
    "gt_sql": "SELECT Store_Number, COUNT(DISTINCT SKU_Coded) FROM sales WHERE YEAR(Sold_Date) = 2023 GROUP BY Store_Number ORDER BY COUNT(DISTINCT SKU_Coded) DESC, Store_Number ASC LIMIT 50",
    "gt_data": "    Store_Number  count(DISTINCT SKU_Coded)\n0           2640                        453\n1           1320                        449\n2           3300                        448\n3            990                        447\n4           1540                        447\n5           2310                        446\n6           2970                        446\n7           2090                        444\n8           3190                        443\n9           3410                        443\n10          3630                        443\n11          4840                        443\n12          1650                        441\n13          2420                        441\n14          4070                        440\n15          4180                        438\n16          1100                        437\n17          4730                        437\n18          2200                        436\n19          2530                        436\n20          2750                        435\n21          3080                        434\n22          3740                        433\n23          1870                        429\n24          1980                        428\n25          1760                        427\n26          2860                        427\n27          3520                        427\n28          1210                        420\n29           880                        402\n30           660                        398\n31           330                        391\n32           770                        387\n33           550                        379\n34          4400                        245",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_16_gt.csv",
    "gen_sql": "SELECT Store_Number, COUNT(DISTINCT SKU_Coded) AS distinct_sku_count\nFROM sales\nWHERE CAST(Sold_Date AS VARCHAR) LIKE '%2023%'\nGROUP BY Store_Number\nORDER BY distinct_sku_count DESC, Store_Number ASC\nLIMIT 50;",
    "gen_data": "    Store_Number  distinct_sku_count\n0           2640                 453\n1           1320                 449\n2           3300                 448\n3            990                 447\n4           1540                 447\n5           2310                 446\n6           2970                 446\n7           2090                 444\n8           3190                 443\n9           3410                 443\n10          3630                 443\n11          4840                 443\n12          1650                 441\n13          2420                 441\n14          4070                 440\n15          4180                 438\n16          1100                 437\n17          4730                 437\n18          2200                 436\n19          2530                 436\n20          2750                 435\n21          3080                 434\n22          3740                 433\n23          1870                 429\n24          1980                 428\n25          1760                 427\n26          2860                 427\n27          3520                 427\n28          1210                 420\n29           880                 402\n30           660                 398\n31           330                 391\n32           770                 387\n33           550                 379\n34          4400                 245",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_16_gen.csv"
  },
  {
    "prompt": "For 2023, return the top 30 Product_Class_Code by promotional units sold (On_Promo=1); tie-break by Product_Class_Code ASC.",
    "gt_sql": "SELECT Product_Class_Code, sum(Qty_Sold) FROM sales WHERE YEAR(Sold_Date) = 2023 AND On_Promo = 1 GROUP BY Product_Class_Code ORDER BY sum(Qty_Sold) DESC, Product_Class_Code ASC LIMIT 30",
    "gt_data": "   Product_Class_Code  sum(Qty_Sold)\n0               22850         4048.0\n1               22975          863.0\n2               24425          763.0\n3               22900          761.0\n4               22950           92.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_17_gt.csv",
    "gen_sql": "SELECT Product_Class_Code, SUM(Qty_Sold) AS Promo_Units_Sold\nFROM sales\nWHERE On_Promo = 1\n  AND CAST(Sold_Date AS VARCHAR) LIKE '%2023%'\nGROUP BY Product_Class_Code\nORDER BY Promo_Units_Sold DESC, Product_Class_Code ASC\nLIMIT 30;",
    "gen_data": "   Product_Class_Code  Promo_Units_Sold\n0               22850            4048.0\n1               22975             863.0\n2               24425             763.0\n3               22900             761.0\n4               22950              92.0",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_17_gen.csv"
  },
  {
    "prompt": "Across the full dataset, return the 40 SKUs with the highest average unit price among SKUs with at least 50 units sold; avg_unit_price = sum(Total_Sale_Value)/sum(Qty_Sold); tie-break by SKU_Coded ASC.",
    "gt_sql": "SELECT SKU_Coded, sum(Total_Sale_Value) / sum(Qty_Sold), sum(Qty_Sold), sum(Total_Sale_Value) FROM sales GROUP BY SKU_Coded HAVING sum(Qty_Sold) >= 50 ORDER BY sum(Total_Sale_Value) / sum(Qty_Sold) DESC, SKU_Coded ASC LIMIT 40",
    "gt_data": "    SKU_Coded  (sum(Total_Sale_Value) / sum(Qty_Sold))  sum(Qty_Sold)  sum(Total_Sale_Value)\n0     6204850                               148.910149          415.0           61797.711670\n1     6204800                               113.203668          540.0           61129.980629\n2     6185100                                99.552126         1330.0          132404.327278\n3     6195750                                89.929595          149.0           13399.509682\n4     6184900                                89.549110         3817.0          341808.952810\n5     6179650                                85.405995          607.0           51841.438976\n6     6202800                                79.963331          150.0           11994.499710\n7     6202350                                79.673314          585.0           46608.888786\n8     6197600                                79.662474          961.0           76555.637985\n9     6202500                                78.955015          297.0           23449.639423\n10    6186250                                69.497521         2358.0          163875.155296\n11    6203450                                69.229686           96.0            6646.049843\n12    6198500                                68.905880          391.0           26942.199215\n13    6195250                                60.477207          569.0           34411.530737\n14    6185150                                59.722789          427.0           25501.630703\n15    6202900                                59.095934          177.0           10459.980293\n16    6196350                                58.232667          619.0           36046.020971\n17    6176250                                55.351915         2645.0          146405.814148\n18    6176200                                55.336678         2702.0          149519.704277\n19    6192500                                54.697923         1352.0           73951.592205\n20    6196200                                54.198661         1366.0           74035.371582\n21    6197000                                53.483860          101.0            5401.869850\n22    6179600                                49.800600         2090.0          104083.253410\n23    6187700                                49.601256          255.0           12648.320265\n24    6190450                                49.551977         2136.0          105843.023338\n25    6200000                                49.547903          672.0           33296.191074\n26    6198550                                49.532701          426.0           21100.930643\n27    6199050                                49.468417          694.0           34331.081085\n28    6190500                                49.447309         1196.0           59138.981873\n29    6193250                                48.936241          484.0           23685.140501\n30    6196550                                48.301811         1039.0           50185.581646\n31    6191400                                46.821826         5657.0          264871.067286\n32    6199300                                46.615198         1828.0           85212.582848\n33    6193200                                46.034189         2627.0          120931.813671\n34    6199150                                45.887521         1532.0           70299.682259\n35    6199250                                45.613453         2341.0          106781.093248\n36    6188750                                45.345383          301.0           13648.960375\n37    6199100                                44.724452          910.0           40699.251480\n38    6200550                                44.461141          518.0           23030.870823\n39    6196500                                43.588645          531.0           23145.570544",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_18_gt.csv",
    "gen_sql": "SELECT SKU_Coded, SUM(Total_Sale_Value)/SUM(Qty_Sold) AS avg_unit_price\nFROM sales\nGROUP BY SKU_Coded\nHAVING SUM(Qty_Sold) >= 50\nORDER BY avg_unit_price DESC, SKU_Coded ASC\nLIMIT 40;",
    "gen_data": "    SKU_Coded  avg_unit_price\n0     6204850      148.910149\n1     6204800      113.203668\n2     6185100       99.552126\n3     6195750       89.929595\n4     6184900       89.549110\n5     6179650       85.405995\n6     6202800       79.963331\n7     6202350       79.673314\n8     6197600       79.662474\n9     6202500       78.955015\n10    6186250       69.497521\n11    6203450       69.229686\n12    6198500       68.905880\n13    6195250       60.477207\n14    6185150       59.722789\n15    6202900       59.095934\n16    6196350       58.232667\n17    6176250       55.351915\n18    6176200       55.336678\n19    6192500       54.697923\n20    6196200       54.198661\n21    6197000       53.483860\n22    6179600       49.800600\n23    6187700       49.601256\n24    6190450       49.551977\n25    6200000       49.547903\n26    6198550       49.532701\n27    6199050       49.468417\n28    6190500       49.447309\n29    6193250       48.936241\n30    6196550       48.301811\n31    6191400       46.821826\n32    6199300       46.615198\n33    6193200       46.034189\n34    6199150       45.887521\n35    6199250       45.613453\n36    6188750       45.345383\n37    6199100       44.724452\n38    6200550       44.461141\n39    6196500       43.588645",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_18_gen.csv"
  },
  {
    "prompt": "Return the 30 most recent Sold_Date values aggregated by date; order by Sold_Date DESC.",
    "gt_sql": "SELECT Sold_Date, sum(Total_Sale_Value), sum(Qty_Sold) FROM sales GROUP BY Sold_Date ORDER BY Sold_Date DESC LIMIT 30",
    "gt_data": "    Sold_Date  sum(Total_Sale_Value)  sum(Qty_Sold)\n0  2024-03-31           11465.159956          865.0\n1  2024-03-30           12130.429914         1043.0\n2  2024-03-29           18130.919942         1446.0\n3  2024-03-28           12410.239968         1033.0\n4  2024-03-27            9486.669932          797.0\n5  2024-03-26            8913.299928          808.0\n6  2024-03-25            9394.489947          814.0\n7  2024-03-24           11490.389904          973.0\n8  2024-03-22           14739.649938         1310.0\n9  2024-03-21           12593.679940         1017.0\n10 2024-03-20           10035.429957          723.0\n11 2024-03-19            9781.329939          779.0\n12 2024-03-18            8151.019921          759.0\n13 2024-03-17            8685.079932          723.0\n14 2024-03-16           12654.869916         1019.0\n15 2024-03-15           16860.119913         1341.0\n16 2024-03-14           12704.229942         1104.0\n17 2024-03-13           10113.479960          731.0\n18 2024-03-12            9319.179927          743.0\n19 2024-03-11            9057.659943          718.0\n20 2024-03-10           10858.899962          816.0\n21 2024-03-09           12723.899937         1012.0\n22 2024-03-08           18448.579874         1541.0\n23 2024-03-07           12583.609902         1029.0\n24 2024-03-06           10497.679946          803.0\n25 2024-03-05            9982.559910          730.0\n26 2024-03-04            9461.179928          766.0\n27 2024-03-03           11190.739941          941.0\n28 2024-03-02           13834.259921         1101.0\n29 2024-03-01           16214.309858         1499.0",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_19_gt.csv",
    "gen_sql": "SELECT CAST(Sold_Date AS DATE) AS Sale_Date,\n       COUNT(*) AS Sales_Count,\n       SUM(Qty_Sold) AS Total_Qty,\n       SUM(Total_Sale_Value) AS Total_Sales\nFROM sales\nGROUP BY CAST(Sold_Date AS DATE)\nORDER BY Sale_Date DESC\nLIMIT 30;",
    "gen_data": "    Sale_Date  Sales_Count  Total_Qty   Total_Sales\n0  2024-03-31          588      865.0  11465.159956\n1  2024-03-30          701     1043.0  12130.429914\n2  2024-03-29          929     1446.0  18130.919942\n3  2024-03-28          674     1033.0  12410.239968\n4  2024-03-27          529      797.0   9486.669932\n5  2024-03-26          513      808.0   8913.299928\n6  2024-03-25          555      814.0   9394.489947\n7  2024-03-24          652      973.0  11490.389904\n8  2024-03-22          850     1310.0  14739.649938\n9  2024-03-21          688     1017.0  12593.679940\n10 2024-03-20          538      723.0  10035.429957\n11 2024-03-19          543      779.0   9781.329939\n12 2024-03-18          512      759.0   8151.019921\n13 2024-03-17          536      723.0   8685.079932\n14 2024-03-16          756     1019.0  12654.869916\n15 2024-03-15          911     1341.0  16860.119913\n16 2024-03-14          731     1104.0  12704.229942\n17 2024-03-13          499      731.0  10113.479960\n18 2024-03-12          529      743.0   9319.179927\n19 2024-03-11          529      718.0   9057.659943\n20 2024-03-10          593      816.0  10858.899962\n21 2024-03-09          722     1012.0  12723.899937\n22 2024-03-08         1011     1541.0  18448.579874\n23 2024-03-07          699     1029.0  12583.609902\n24 2024-03-06          535      803.0  10497.679946\n25 2024-03-05          553      730.0   9982.559910\n26 2024-03-04          538      766.0   9461.179928\n27 2024-03-03          608      941.0  11190.739941\n28 2024-03-02          781     1101.0  13834.259921\n29 2024-03-01          932     1499.0  16214.309858",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_19_gen.csv"
  },
  {
    "prompt": "For 2022, return the top 25 stores by total units sold for Product_Class_Code = 22975; tie-break by Store_Number ASC.",
    "gt_sql": "SELECT Store_Number, sum(Qty_Sold), sum(Total_Sale_Value) FROM sales WHERE YEAR(Sold_Date) = 2022 AND Product_Class_Code = 22975 GROUP BY Store_Number ORDER BY sum(Qty_Sold) DESC, Store_Number ASC LIMIT 25",
    "gt_data": "    Store_Number  sum(Qty_Sold)  sum(Total_Sale_Value)\n0           2970         4061.0           67735.229967\n1           3080         3201.0           47103.769739\n2           1210         3179.0           53590.399891\n3           1650         2889.0           51583.809919\n4           3300         2872.0           52745.349853\n5           1100         2748.0           44162.889747\n6           1320         2506.0           50930.190013\n7           2750         2399.0           41942.669923\n8           2420         2239.0           41258.299958\n9           2200         2111.0           39076.459951\n10          2310         2019.0           36246.150019\n11           990         2012.0           41125.950106\n12           880         2005.0           38132.759994\n13          3410         1938.0           33407.269839\n14           330         1913.0           33351.169944\n15           660         1909.0           35899.000001\n16          3630         1898.0           34752.339867\n17          1540         1775.0           30341.179863\n18          1870         1758.0           32101.399936\n19          4840         1744.0           28351.719901\n20          3740         1739.0           30222.319891\n21          2090         1599.0           26344.379813\n22          4070         1576.0           29304.379972\n23          1760         1559.0           30691.659863\n24          3190         1543.0           26704.299887",
    "gt_csv_path": "evaluation/csv_queries/gptoss20-gpt_20_gt.csv",
    "gen_sql": "SELECT Store_Number\nFROM sales\nWHERE Product_Class_Code = 22975\n  AND CAST(Sold_Date AS VARCHAR) LIKE '%2022%'\nGROUP BY Store_Number\nORDER BY SUM(Qty_Sold) DESC, Store_Number ASC\nLIMIT 25;",
    "gen_data": "    Store_Number\n0           2970\n1           3080\n2           1210\n3           1650\n4           3300\n5           1100\n6           1320\n7           2750\n8           2420\n9           2200\n10          2310\n11           990\n12           880\n13          3410\n14           330\n15           660\n16          3630\n17          1540\n18          1870\n19          4840\n20          3740\n21          2090\n22          4070\n23          1760\n24          3190",
    "gen_csv_path": "evaluation/csv_queries/gptoss20-gpt_20_gen.csv"
  }
]