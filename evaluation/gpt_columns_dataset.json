[
  {
    "prompt": "Return the 12 months of 2023 with total revenue and total units sold; columns: month_start, total_revenue, total_units; order by month_start ASC.",
    "gt_sql": "SELECT DATE_TRUNC('month', Sold_Date) AS month_start, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY DATE_TRUNC('month', Sold_Date) ORDER BY month_start ASC",
    "gt_data": "   month_start  total_revenue  total_units\n0   2023-01-01  434172.808300      33653.0\n1   2023-02-01  411762.718244      31545.0\n2   2023-03-01  423070.838309      32460.0\n3   2023-04-01  384479.678311      30199.0\n4   2023-05-01  381326.428023      31154.0\n5   2023-06-01  364806.737856      29082.0\n6   2023-07-01  353284.207838      27932.0\n7   2023-08-01  401061.537729      31903.0\n8   2023-09-01  422554.967469      31847.0\n9   2023-10-01  454231.057104      38208.0\n10  2023-11-01  511104.287418      41043.0\n11  2023-12-01  874263.668331      60941.0",
    "gt_analysis": "The 12 months of 2023 with total revenue and total units sold are: January 2023: $434,172.81 revenue, 33,653 units; February 2023: $411,762.72 revenue, 31,545 units; March 2023: $423,070.84 revenue, 32,460 units; April 2023: $384,479.68 revenue, 30,199 units; May 2023: $381,326.43 revenue, 31,154 units; June 2023: $364,806.74 revenue, 29,082 units; July 2023: $353,284.21 revenue, 27,932 units; August 2023: $401,061.54 revenue, 31,903 units; September 2023: $422,554.97 revenue, 31,847 units; October 2023: $454,231.06 revenue, 38,208 units; November 2023: $511,104.29 revenue, 41,043 units; December 2023: $874,263.67 revenue, 60,941 units."
  },
  {
    "prompt": "Return the top 20 SKUs by total units sold across the full dataset; tie-break by higher total revenue, then SKU_Coded ASC; columns: SKU_Coded, total_units, total_revenue.",
    "gt_sql": "SELECT SKU_Coded, SUM(Qty_Sold) AS total_units, SUM(Total_Sale_Value) AS total_revenue FROM sales GROUP BY SKU_Coded ORDER BY total_units DESC, total_revenue DESC, SKU_Coded ASC LIMIT 20",
    "gt_data": "    SKU_Coded  total_units  total_revenue\n0     6200700      52262.0  515088.125879\n1     6194250      14905.0  296872.717907\n2     6193800      13744.0  102779.887266\n3     6177750      12982.0   24268.139672\n4     6177350      12702.0  107732.197505\n5     6200650      12599.0  125459.188012\n6     6187750      11909.0   94285.607714\n7     6191100      11750.0   93128.078166\n8     6190100      11293.0   14756.900020\n9     6200800      10577.0   25954.219908\n10    6179250       9731.0  145054.308485\n11    6179200       9411.0   52888.138254\n12    6192300       8845.0   35013.700175\n13    6195800       8676.0   84304.989587\n14    6182050       8539.0   67969.048205\n15    6173350       8419.0   73853.650037\n16    6177450       8396.0   41803.148624\n17    6184100       7988.0  158712.088621\n18    6201750       7931.0    7774.890016\n19    6178100       7911.0   39385.088725",
    "gt_analysis": "The top 20 SKUs by total units sold are: SKU 6200700 with 52,262 units and $515,088.13 revenue; SKU 6194250 with 14,905 units and $296,872.72 revenue; SKU 6193800 with 13,744 units and $102,779.89 revenue; SKU 6177750 with 12,982 units and $24,268.14 revenue; SKU 6177350 with 12,702 units and $107,732.20 revenue; SKU 6200650 with 12,599 units and $125,459.19 revenue; SKU 6187750 with 11,909 units and $94,285.61 revenue; SKU 6191100 with 11,750 units and $93,128.08 revenue; SKU 6190100 with 11,293 units and $14,756.90 revenue; SKU 6200800 with 10,577 units and $25,954.22 revenue; SKU 6179250 with 9,731 units and $145,054.31 revenue; SKU 6179200 with 9,411 units and $52,888.14 revenue; SKU 6192300 with 8,845 units and $35,013.70 revenue; SKU 6195800 with 8,676 units and $84,304.99 revenue; SKU 6182050 with 8,539 units and $67,969.05 revenue; SKU 6173350 with 8,419 units and $73,853.65 revenue; SKU 6177450 with 8,396 units and $41,803.15 revenue; SKU 6184100 with 7,988 units and $158,712.09 revenue; SKU 6201750 with 7,931 units and $7,774.89 revenue; SKU 6178100 with 7,911 units and $39,385.09 revenue."
  },
  {
    "prompt": "For 2022, return the top 15 Product_Class_Code by total revenue; tie-break by higher total units, then Product_Class_Code ASC; columns: Product_Class_Code, total_revenue, total_units.",
    "gt_sql": "SELECT Product_Class_Code, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2022 GROUP BY Product_Class_Code ORDER BY total_revenue DESC, total_units DESC, Product_Class_Code ASC LIMIT 15",
    "gt_data": "    Product_Class_Code  total_revenue  total_units\n0                22975   1.135793e+06      64028.0\n1                22800   8.047909e+05      59710.0\n2                24425   7.089950e+05      42726.0\n3                24400   6.123823e+05      43787.0\n4                22850   4.873798e+05      47988.0\n5                22900   4.447206e+05       9750.0\n6                24375   4.390179e+05      13785.0\n7                22875   2.937181e+05      61898.0\n8                22950   1.409884e+05      28590.0\n9                22925   1.197567e+05      16921.0\n10               22825   1.081189e+05      16054.0",
    "gt_analysis": "The top 15 Product_Class_Code by total revenue for 2022 are: Product Class 22975 with $1,135,793.00 revenue and 64,028 units; Product Class 22800 with $804,790.90 revenue and 59,710 units; Product Class 24425 with $708,995.00 revenue and 42,726 units; Product Class 24400 with $612,382.30 revenue and 43,787 units; Product Class 22850 with $487,379.80 revenue and 47,988 units; Product Class 22900 with $444,720.60 revenue and 9,750 units; Product Class 24375 with $439,017.90 revenue and 13,785 units; Product Class 22875 with $293,718.10 revenue and 61,898 units; Product Class 22950 with $140,988.40 revenue and 28,590 units; Product Class 22925 with $119,756.70 revenue and 16,921 units; Product Class 22825 with $108,118.90 revenue and 16,054 units."
  },
  {
    "prompt": "For 2023, return the top 25 stores by promotional unit share (promo_units/total_units) among stores with at least 100 total units; tie-break by Store_Number ASC; columns: Store_Number, promo_unit_share, promo_units, total_units.",
    "gt_sql": "SELECT Store_Number, SUM(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END) * 1.0 / SUM(Qty_Sold) AS promo_unit_share, SUM(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END) AS promo_units, SUM(Qty_Sold) AS total_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY Store_Number HAVING SUM(Qty_Sold) >= 100 ORDER BY promo_unit_share DESC, Store_Number ASC LIMIT 25",
    "gt_data": "    Store_Number  promo_unit_share  promo_units  total_units\n0           2860          0.034158        250.0       7319.0\n1           3190          0.031972        360.0      11260.0\n2            770          0.030119        312.0      10359.0\n3           1980          0.026000        223.0       8577.0\n4           1540          0.024591        299.0      12159.0\n5           2640          0.023646        290.0      12264.0\n6           2090          0.022339        230.0      10296.0\n7            990          0.022317        252.0      11292.0\n8           3520          0.020542        144.0       7010.0\n9           4180          0.020420        173.0       8472.0\n10          4070          0.019401        235.0      12113.0\n11          3740          0.019384        212.0      10937.0\n12          2420          0.018709        284.0      15180.0\n13          2530          0.017813        179.0      10049.0\n14          4730          0.015883        122.0       7681.0\n15          1100          0.015381        243.0      15799.0\n16          2310          0.015083        186.0      12332.0\n17          3630          0.014586        206.0      14123.0\n18          3080          0.014562        195.0      13391.0\n19          2200          0.014395        141.0       9795.0\n20          1870          0.013401        150.0      11193.0\n21          2750          0.013273        184.0      13863.0\n22          4840          0.012128        142.0      11708.0\n23          1320          0.012087        235.0      19443.0\n24           330          0.011786        140.0      11879.0",
    "gt_analysis": "Store_Number: 2860, promo_unit_share: 0.034158, promo_units: 250.0, total_units: 7319.0; Store_Number: 3190, promo_unit_share: 0.031972, promo_units: 360.0, total_units: 11260.0; Store_Number: 770, promo_unit_share: 0.030119, promo_units: 312.0, total_units: 10359.0; Store_Number: 1980, promo_unit_share: 0.026000, promo_units: 223.0, total_units: 8577.0; Store_Number: 1540, promo_unit_share: 0.024591, promo_units: 299.0, total_units: 12159.0; Store_Number: 2640, promo_unit_share: 0.023646, promo_units: 290.0, total_units: 12264.0; Store_Number: 2090, promo_unit_share: 0.022339, promo_units: 230.0, total_units: 10296.0; Store_Number: 990, promo_unit_share: 0.022317, promo_units: 252.0, total_units: 11292.0; Store_Number: 3520, promo_unit_share: 0.020542, promo_units: 144.0, total_units: 7010.0; Store_Number: 4180, promo_unit_share: 0.020420, promo_units: 173.0, total_units: 8472.0; Store_Number: 4070, promo_unit_share: 0.019401, promo_units: 235.0, total_units: 12113.0; Store_Number: 3740, promo_unit_share: 0.019384, promo_units: 212.0, total_units: 10937.0; Store_Number: 2420, promo_unit_share: 0.018709, promo_units: 284.0, total_units: 15180.0; Store_Number: 2530, promo_unit_share: 0.017813, promo_units: 179.0, total_units: 10049.0; Store_Number: 4730, promo_unit_share: 0.015883, promo_units: 122.0, total_units: 7681.0; Store_Number: 1100, promo_unit_share: 0.015381, promo_units: 243.0, total_units: 15799.0; Store_Number: 2310, promo_unit_share: 0.015083, promo_units: 186.0, total_units: 12332.0; Store_Number: 3630, promo_unit_share: 0.014586, promo_units: 206.0, total_units: 14123.0; Store_Number: 3080, promo_unit_share: 0.014562, promo_units: 195.0, total_units: 13391.0; Store_Number: 2200, promo_unit_share: 0.014395, promo_units: 141.0, total_units: 9795.0; Store_Number: 1870, promo_unit_share: 0.013401, promo_units: 150.0, total_units: 11193.0; Store_Number: 2750, promo_unit_share: 0.013273, promo_units: 184.0, total_units: 13863.0; Store_Number: 4840, promo_unit_share: 0.012128, promo_units: 142.0, total_units: 11708.0; Store_Number: 1320, promo_unit_share: 0.012087, promo_units: 235.0, total_units: 19443.0; Store_Number: 330, promo_unit_share: 0.011786, promo_units: 140.0, total_units: 11879.0"
  },
  {
    "prompt": "For Q1 2023 (2023-01-01 to 2023-03-31), return the top 30 stores by total revenue; tie-break by Store_Number ASC; columns: Store_Number, total_revenue, total_units.",
    "gt_sql": "SELECT Store_Number, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales WHERE Sold_Date >= '2023-01-01' AND Sold_Date <= '2023-03-31' GROUP BY Store_Number ORDER BY total_revenue DESC, Store_Number ASC LIMIT 30",
    "gt_data": "    Store_Number  total_revenue  total_units\n0           2970   76853.159734       5421.0\n1           3300   66626.309749       5318.0\n2           1320   62172.839858       4046.0\n3           1650   56220.139782       4214.0\n4           1100   51486.119914       4098.0\n5           3080   48145.879883       3903.0\n6           1210   43959.729856       3512.0\n7           2420   43363.629744       3883.0\n8           2750   43234.119773       3120.0\n9            880   42863.479745       3534.0\n10          3630   40257.639818       3356.0\n11          2310   38919.459938       2727.0\n12          1540   37388.279729       3087.0\n13           660   37187.619883       2694.0\n14          1870   36756.709768       2846.0\n15          4840   36607.989831       2817.0\n16          3410   36513.879942       2582.0\n17          2090   35334.039831       2924.0\n18          4070   35114.819833       3127.0\n19           330   34503.009759       2814.0\n20           990   34048.199931       2471.0\n21          3740   32873.009876       2274.0\n22          1760   32860.329846       2434.0\n23          2200   31966.259884       2530.0\n24          3190   31134.779882       2401.0\n25           770   29096.689838       2595.0\n26          2640   27016.909833       2143.0\n27          4180   24823.079898       1845.0\n28           550   24038.359882       1928.0\n29          2530   23853.799933       1756.0",
    "gt_analysis": "Store_Number: 2970, total_revenue: 76853.159734, total_units: 5421.0; Store_Number: 3300, total_revenue: 66626.309749, total_units: 5318.0; Store_Number: 1320, total_revenue: 62172.839858, total_units: 4046.0; Store_Number: 1650, total_revenue: 56220.139782, total_units: 4214.0; Store_Number: 1100, total_revenue: 51486.119914, total_units: 4098.0; Store_Number: 3080, total_revenue: 48145.879883, total_units: 3903.0; Store_Number: 1210, total_revenue: 43959.729856, total_units: 3512.0; Store_Number: 2420, total_revenue: 43363.629744, total_units: 3883.0; Store_Number: 2750, total_revenue: 43234.119773, total_units: 3120.0; Store_Number: 880, total_revenue: 42863.479745, total_units: 3534.0; Store_Number: 3630, total_revenue: 40257.639818, total_units: 3356.0; Store_Number: 2310, total_revenue: 38919.459938, total_units: 2727.0; Store_Number: 1540, total_revenue: 37388.279729, total_units: 3087.0; Store_Number: 660, total_revenue: 37187.619883, total_units: 2694.0; Store_Number: 1870, total_revenue: 36756.709768, total_units: 2846.0; Store_Number: 4840, total_revenue: 36607.989831, total_units: 2817.0; Store_Number: 3410, total_revenue: 36513.879942, total_units: 2582.0; Store_Number: 2090, total_revenue: 35334.039831, total_units: 2924.0; Store_Number: 4070, total_revenue: 35114.819833, total_units: 3127.0; Store_Number: 330, total_revenue: 34503.009759, total_units: 2814.0; Store_Number: 990, total_revenue: 34048.199931, total_units: 2471.0; Store_Number: 3740, total_revenue: 32873.009876, total_units: 2274.0; Store_Number: 1760, total_revenue: 32860.329846, total_units: 2434.0; Store_Number: 2200, total_revenue: 31966.259884, total_units: 2530.0; Store_Number: 3190, total_revenue: 31134.779882, total_units: 2401.0; Store_Number: 770, total_revenue: 29096.689838, total_units: 2595.0; Store_Number: 2640, total_revenue: 27016.909833, total_units: 2143.0; Store_Number: 4180, total_revenue: 24823.079898, total_units: 1845.0; Store_Number: 550, total_revenue: 24038.359882, total_units: 1928.0; Store_Number: 2530, total_revenue: 23853.799933, total_units: 1756.0"
  },
  {
    "prompt": "For 2023, return the top 10 SKUs by total revenue with avg unit price = sum(Total_Sale_Value)/sum(Qty_Sold); tie-break by SKU_Coded ASC; columns: SKU_Coded, total_revenue, total_units, avg_unit_price.",
    "gt_sql": "SELECT SKU_Coded, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units, SUM(Total_Sale_Value) / SUM(Qty_Sold) AS avg_unit_price FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY SKU_Coded ORDER BY total_revenue DESC, SKU_Coded ASC LIMIT 10",
    "gt_data": "   SKU_Coded  total_revenue  total_units  avg_unit_price\n0    6200700  353964.937498      36081.0        9.810286\n1    6184900  147797.616945       1651.0       89.520059\n2    6194250  116109.579178       5824.0       19.936398\n3    6200650   83765.828704       8405.0        9.966190\n4    6191400   70791.602219       1581.0       44.776472\n5    6184100   67589.119407       3396.0       19.902568\n6    6186250   66756.588099        960.0       69.538113\n7    6176200   60119.691723       1086.0       55.358832\n8    6199250   57957.061886       1273.0       45.527935\n9    6179250   54660.029366       3675.0       14.873477",
    "gt_analysis": "SKU_Coded: 6200700, total_revenue: 353964.937498, total_units: 36081.0, avg_unit_price: 9.810286; SKU_Coded: 6184900, total_revenue: 147797.616945, total_units: 1651.0, avg_unit_price: 89.520059; SKU_Coded: 6194250, total_revenue: 116109.579178, total_units: 5824.0, avg_unit_price: 19.936398; SKU_Coded: 6200650, total_revenue: 83765.828704, total_units: 8405.0, avg_unit_price: 9.966190; SKU_Coded: 6191400, total_revenue: 70791.602219, total_units: 1581.0, avg_unit_price: 44.776472; SKU_Coded: 6184100, total_revenue: 67589.119407, total_units: 3396.0, avg_unit_price: 19.902568; SKU_Coded: 6186250, total_revenue: 66756.588099, total_units: 960.0, avg_unit_price: 69.538113; SKU_Coded: 6176200, total_revenue: 60119.691723, total_units: 1086.0, avg_unit_price: 55.358832; SKU_Coded: 6199250, total_revenue: 57957.061886, total_units: 1273.0, avg_unit_price: 45.527935; SKU_Coded: 6179250, total_revenue: 54660.029366, total_units: 3675.0, avg_unit_price: 14.873477"
  },
  {
    "prompt": "For 2023, return month-by-promo aggregates with columns: month_start, On_Promo, total_revenue, total_units; order by month_start ASC, On_Promo ASC; expect 24 rows.",
    "gt_sql": "SELECT DATE_TRUNC('month', Sold_Date) AS month_start, On_Promo, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY DATE_TRUNC('month', Sold_Date), On_Promo ORDER BY month_start ASC, On_Promo ASC",
    "gt_data": "   month_start  On_Promo  total_revenue  total_units\n0   2023-01-01         0  434102.828296      33651.0\n1   2023-01-01         1      69.980003          2.0\n2   2023-02-01         0  411762.718244      31545.0\n3   2023-03-01         0  423070.838309      32460.0\n4   2023-04-01         0  378326.478314      29351.0\n5   2023-04-01         1    6153.199997        848.0\n6   2023-05-01         0  379860.538039      30943.0\n7   2023-05-01         1    1465.889984        211.0\n8   2023-06-01         0  364806.737856      29082.0\n9   2023-07-01         0  353284.207838      27932.0\n10  2023-08-01         0  398592.447746      31612.0\n11  2023-08-01         1    2469.089983        291.0\n12  2023-09-01         0  415126.857461      31789.0\n13  2023-09-01         1    7428.110008         58.0\n14  2023-10-01         0  446184.807069      36423.0\n15  2023-10-01         1    8046.250035       1785.0\n16  2023-11-01         0  476004.377225      39141.0\n17  2023-11-01         1   35099.910192       1902.0\n18  2023-12-01         0  835289.237587      59511.0\n19  2023-12-01         1   38974.430744       1430.0",
    "gt_analysis": "month_start: 2023-01-01, On_Promo: 0, total_revenue: 434102.828296, total_units: 33651.0; month_start: 2023-01-01, On_Promo: 1, total_revenue: 69.980003, total_units: 2.0; month_start: 2023-02-01, On_Promo: 0, total_revenue: 411762.718244, total_units: 31545.0; month_start: 2023-03-01, On_Promo: 0, total_revenue: 423070.838309, total_units: 32460.0; month_start: 2023-04-01, On_Promo: 0, total_revenue: 378326.478314, total_units: 29351.0; month_start: 2023-04-01, On_Promo: 1, total_revenue: 6153.199997, total_units: 848.0; month_start: 2023-05-01, On_Promo: 0, total_revenue: 379860.538039, total_units: 30943.0; month_start: 2023-05-01, On_Promo: 1, total_revenue: 1465.889984, total_units: 211.0; month_start: 2023-06-01, On_Promo: 0, total_revenue: 364806.737856, total_units: 29082.0; month_start: 2023-07-01, On_Promo: 0, total_revenue: 353284.207838, total_units: 27932.0; month_start: 2023-08-01, On_Promo: 0, total_revenue: 398592.447746, total_units: 31612.0; month_start: 2023-08-01, On_Promo: 1, total_revenue: 2469.089983, total_units: 291.0; month_start: 2023-09-01, On_Promo: 0, total_revenue: 415126.857461, total_units: 31789.0; month_start: 2023-09-01, On_Promo: 1, total_revenue: 7428.110008, total_units: 58.0; month_start: 2023-10-01, On_Promo: 0, total_revenue: 446184.807069, total_units: 36423.0; month_start: 2023-10-01, On_Promo: 1, total_revenue: 8046.250035, total_units: 1785.0; month_start: 2023-11-01, On_Promo: 0, total_revenue: 476004.377225, total_units: 39141.0; month_start: 2023-11-01, On_Promo: 1, total_revenue: 35099.910192, total_units: 1902.0; month_start: 2023-12-01, On_Promo: 0, total_revenue: 835289.237587, total_units: 59511.0; month_start: 2023-12-01, On_Promo: 1, total_revenue: 38974.430744, total_units: 1430.0"
  },
  {
    "prompt": "For 2023, return the top 50 stores by distinct SKUs sold; tie-break by Store_Number ASC; columns: Store_Number, distinct_skus.",
    "gt_sql": "SELECT Store_Number, COUNT(DISTINCT SKU_Coded) AS distinct_skus FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY Store_Number ORDER BY distinct_skus DESC, Store_Number ASC LIMIT 50",
    "gt_data": "    Store_Number  distinct_skus\n0           2640            453\n1           1320            449\n2           3300            448\n3            990            447\n4           1540            447\n5           2310            446\n6           2970            446\n7           2090            444\n8           3190            443\n9           3410            443\n10          3630            443\n11          4840            443\n12          1650            441\n13          2420            441\n14          4070            440\n15          4180            438\n16          1100            437\n17          4730            437\n18          2200            436\n19          2530            436\n20          2750            435\n21          3080            434\n22          3740            433\n23          1870            429\n24          1980            428\n25          1760            427\n26          2860            427\n27          3520            427\n28          1210            420\n29           880            402\n30           660            398\n31           330            391\n32           770            387\n33           550            379\n34          4400            245",
    "gt_analysis": "Store_Number: 2640, distinct_skus: 453; Store_Number: 1320, distinct_skus: 449; Store_Number: 3300, distinct_skus: 448; Store_Number: 990, distinct_skus: 447; Store_Number: 1540, distinct_skus: 447; Store_Number: 2310, distinct_skus: 446; Store_Number: 2970, distinct_skus: 446; Store_Number: 2090, distinct_skus: 444; Store_Number: 3190, distinct_skus: 443; Store_Number: 3410, distinct_skus: 443; Store_Number: 3630, distinct_skus: 443; Store_Number: 4840, distinct_skus: 443; Store_Number: 1650, distinct_skus: 441; Store_Number: 2420, distinct_skus: 441; Store_Number: 4070, distinct_skus: 440; Store_Number: 4180, distinct_skus: 438; Store_Number: 1100, distinct_skus: 437; Store_Number: 4730, distinct_skus: 437; Store_Number: 2200, distinct_skus: 436; Store_Number: 2530, distinct_skus: 436; Store_Number: 2750, distinct_skus: 435; Store_Number: 3080, distinct_skus: 434; Store_Number: 3740, distinct_skus: 433; Store_Number: 1870, distinct_skus: 429; Store_Number: 1980, distinct_skus: 428; Store_Number: 1760, distinct_skus: 427; Store_Number: 2860, distinct_skus: 427; Store_Number: 3520, distinct_skus: 427; Store_Number: 1210, distinct_skus: 420; Store_Number: 880, distinct_skus: 402; Store_Number: 660, distinct_skus: 398; Store_Number: 330, distinct_skus: 391; Store_Number: 770, distinct_skus: 387; Store_Number: 550, distinct_skus: 379; Store_Number: 4400, distinct_skus: 245"
  },
  {
    "prompt": "For 2023, return the top 30 Product_Class_Code by promotional units sold (On_Promo=1); tie-break by Product_Class_Code ASC; columns: Product_Class_Code, promo_units.",
    "gt_sql": "SELECT Product_Class_Code, SUM(Qty_Sold) AS promo_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 AND On_Promo = 1 GROUP BY Product_Class_Code ORDER BY promo_units DESC, Product_Class_Code ASC LIMIT 30",
    "gt_data": "   Product_Class_Code  promo_units\n0               22850       4048.0\n1               22975        863.0\n2               24425        763.0\n3               22900        761.0\n4               22950         92.0",
    "gt_analysis": "Product_Class_Code: 22850, promo_units: 4048.0; Product_Class_Code: 22975, promo_units: 863.0; Product_Class_Code: 24425, promo_units: 763.0; Product_Class_Code: 22900, promo_units: 761.0; Product_Class_Code: 22950, promo_units: 92.0"
  },
  {
    "prompt": "Across the full dataset, return the 40 SKUs with the highest average unit price among SKUs with at least 50 units sold; avg_unit_price = sum(Total_Sale_Value)/sum(Qty_Sold); tie-break by SKU_Coded ASC; columns: SKU_Coded, avg_unit_price, total_units, total_revenue.",
    "gt_sql": "SELECT SKU_Coded, SUM(Total_Sale_Value) / SUM(Qty_Sold) AS avg_unit_price, SUM(Qty_Sold) AS total_units, SUM(Total_Sale_Value) AS total_revenue FROM sales GROUP BY SKU_Coded HAVING SUM(Qty_Sold) >= 50 ORDER BY avg_unit_price DESC, SKU_Coded ASC LIMIT 40",
    "gt_data": "    SKU_Coded  avg_unit_price  total_units  total_revenue\n0     6204850      148.910149        415.0   61797.711670\n1     6204800      113.203668        540.0   61129.980629\n2     6185100       99.552126       1330.0  132404.327278\n3     6195750       89.929595        149.0   13399.509682\n4     6184900       89.549110       3817.0  341808.952810\n5     6179650       85.405995        607.0   51841.438976\n6     6202800       79.963331        150.0   11994.499710\n7     6202350       79.673314        585.0   46608.888786\n8     6197600       79.662474        961.0   76555.637985\n9     6202500       78.955015        297.0   23449.639423\n10    6186250       69.497521       2358.0  163875.155296\n11    6203450       69.229686         96.0    6646.049843\n12    6198500       68.905880        391.0   26942.199215\n13    6195250       60.477207        569.0   34411.530737\n14    6185150       59.722789        427.0   25501.630703\n15    6202900       59.095934        177.0   10459.980293\n16    6196350       58.232667        619.0   36046.020971\n17    6176250       55.351915       2645.0  146405.814148\n18    6176200       55.336678       2702.0  149519.704277\n19    6192500       54.697923       1352.0   73951.592205\n20    6196200       54.198661       1366.0   74035.371582\n21    6197000       53.483860        101.0    5401.869850\n22    6179600       49.800600       2090.0  104083.253410\n23    6187700       49.601256        255.0   12648.320265\n24    6190450       49.551977       2136.0  105843.023338\n25    6200000       49.547903        672.0   33296.191074\n26    6198550       49.532701        426.0   21100.930643\n27    6199050       49.468417        694.0   34331.081085\n28    6190500       49.447309       1196.0   59138.981873\n29    6193250       48.936241        484.0   23685.140501\n30    6196550       48.301811       1039.0   50185.581646\n31    6191400       46.821826       5657.0  264871.067286\n32    6199300       46.615198       1828.0   85212.582848\n33    6193200       46.034189       2627.0  120931.813671\n34    6199150       45.887521       1532.0   70299.682259\n35    6199250       45.613453       2341.0  106781.093248\n36    6188750       45.345383        301.0   13648.960375\n37    6199100       44.724452        910.0   40699.251480\n38    6200550       44.461141        518.0   23030.870823\n39    6196500       43.588645        531.0   23145.570544",
    "gt_analysis": "SKU_Coded: 6204850, avg_unit_price: 148.910149, total_units: 415.0, total_revenue: 61797.711670; SKU_Coded: 6204800, avg_unit_price: 113.203668, total_units: 540.0, total_revenue: 61129.980629; SKU_Coded: 6185100, avg_unit_price: 99.552126, total_units: 1330.0, total_revenue: 132404.327278; SKU_Coded: 6195750, avg_unit_price: 89.929595, total_units: 149.0, total_revenue: 13399.509682; SKU_Coded: 6184900, avg_unit_price: 89.549110, total_units: 3817.0, total_revenue: 341808.952810; SKU_Coded: 6179650, avg_unit_price: 85.405995, total_units: 607.0, total_revenue: 51841.438976; SKU_Coded: 6202800, avg_unit_price: 79.963331, total_units: 150.0, total_revenue: 11994.499710; SKU_Coded: 6202350, avg_unit_price: 79.673314, total_units: 585.0, total_revenue: 46608.888786; SKU_Coded: 6197600, avg_unit_price: 79.662474, total_units: 961.0, total_revenue: 76555.637985; SKU_Coded: 6202500, avg_unit_price: 78.955015, total_units: 297.0, total_revenue: 23449.639423; SKU_Coded: 6186250, avg_unit_price: 69.497521, total_units: 2358.0, total_revenue: 163875.155296; SKU_Coded: 6203450, avg_unit_price: 69.229686, total_units: 96.0, total_revenue: 6646.049843; SKU_Coded: 6198500, avg_unit_price: 68.905880, total_units: 391.0, total_revenue: 26942.199215; SKU_Coded: 6195250, avg_unit_price: 60.477207, total_units: 569.0, total_revenue: 34411.530737; SKU_Coded: 6185150, avg_unit_price: 59.722789, total_units: 427.0, total_revenue: 25501.630703; SKU_Coded: 6202900, avg_unit_price: 59.095934, total_units: 177.0, total_revenue: 10459.980293; SKU_Coded: 6196350, avg_unit_price: 58.232667, total_units: 619.0, total_revenue: 36046.020971; SKU_Coded: 6176250, avg_unit_price: 55.351915, total_units: 2645.0, total_revenue: 146405.814148; SKU_Coded: 6176200, avg_unit_price: 55.336678, total_units: 2702.0, total_revenue: 149519.704277; SKU_Coded: 6192500, avg_unit_price: 54.697923, total_units: 1352.0, total_revenue: 73951.592205; SKU_Coded: 6196200, avg_unit_price: 54.198661, total_units: 1366.0, total_revenue: 74035.371582; SKU_Coded: 6197000, avg_unit_price: 53.483860, total_units: 101.0, total_revenue: 5401.869850; SKU_Coded: 6179600, avg_unit_price: 49.800600, total_units: 2090.0, total_revenue: 104083.253410; SKU_Coded: 6187700, avg_unit_price: 49.601256, total_units: 255.0, total_revenue: 12648.320265; SKU_Coded: 6190450, avg_unit_price: 49.551977, total_units: 2136.0, total_revenue: 105843.023338; SKU_Coded: 6200000, avg_unit_price: 49.547903, total_units: 672.0, total_revenue: 33296.191074; SKU_Coded: 6198550, avg_unit_price: 49.532701, total_units: 426.0, total_revenue: 21100.930643; SKU_Coded: 6199050, avg_unit_price: 49.468417, total_units: 694.0, total_revenue: 34331.081085; SKU_Coded: 6190500, avg_unit_price: 49.447309, total_units: 1196.0, total_revenue: 59138.981873; SKU_Coded: 6193250, avg_unit_price: 48.936241, total_units: 484.0, total_revenue: 23685.140501; SKU_Coded: 6196550, avg_unit_price: 48.301811, total_units: 1039.0, total_revenue: 50185.581646; SKU_Coded: 6191400, avg_unit_price: 46.821826, total_units: 5657.0, total_revenue: 264871.067286; SKU_Coded: 6199300, avg_unit_price: 46.615198, total_units: 1828.0, total_revenue: 85212.582848; SKU_Coded: 6193200, avg_unit_price: 46.034189, total_units: 2627.0, total_revenue: 120931.813671; SKU_Coded: 6199150, avg_unit_price: 45.887521, total_units: 1532.0, total_revenue: 70299.682259; SKU_Coded: 6199250, avg_unit_price: 45.613453, total_units: 2341.0, total_revenue: 106781.093248; SKU_Coded: 6188750, avg_unit_price: 45.345383, total_units: 301.0, total_revenue: 13648.960375; SKU_Coded: 6199100, avg_unit_price: 44.724452, total_units: 910.0, total_revenue: 40699.251480; SKU_Coded: 6200550, avg_unit_price: 44.461141, total_units: 518.0, total_revenue: 23030.870823; SKU_Coded: 6196500, avg_unit_price: 43.588645, total_units: 531.0, total_revenue: 23145.570544"
  },
  {
    "prompt": "Return the 30 most recent Sold_Date values aggregated by date with columns: Sold_Date, total_revenue, total_units; order by Sold_Date DESC.",
    "gt_sql": "SELECT Sold_Date, SUM(Total_Sale_Value) AS total_revenue, SUM(Qty_Sold) AS total_units FROM sales GROUP BY Sold_Date ORDER BY Sold_Date DESC LIMIT 30",
    "gt_data": "    Sold_Date  total_revenue  total_units\n0  2024-03-31   11465.159956        865.0\n1  2024-03-30   12130.429914       1043.0\n2  2024-03-29   18130.919942       1446.0\n3  2024-03-28   12410.239968       1033.0\n4  2024-03-27    9486.669932        797.0\n5  2024-03-26    8913.299928        808.0\n6  2024-03-25    9394.489947        814.0\n7  2024-03-24   11490.389904        973.0\n8  2024-03-22   14739.649938       1310.0\n9  2024-03-21   12593.679940       1017.0\n10 2024-03-20   10035.429957        723.0\n11 2024-03-19    9781.329939        779.0\n12 2024-03-18    8151.019921        759.0\n13 2024-03-17    8685.079932        723.0\n14 2024-03-16   12654.869916       1019.0\n15 2024-03-15   16860.119913       1341.0\n16 2024-03-14   12704.229942       1104.0\n17 2024-03-13   10113.479960        731.0\n18 2024-03-12    9319.179927        743.0\n19 2024-03-11    9057.659943        718.0\n20 2024-03-10   10858.899962        816.0\n21 2024-03-09   12723.899937       1012.0\n22 2024-03-08   18448.579874       1541.0\n23 2024-03-07   12583.609902       1029.0\n24 2024-03-06   10497.679946        803.0\n25 2024-03-05    9982.559910        730.0\n26 2024-03-04    9461.179928        766.0\n27 2024-03-03   11190.739941        941.0\n28 2024-03-02   13834.259921       1101.0\n29 2024-03-01   16214.309858       1499.0",
    "gt_analysis": "Sold_Date: 2024-03-31, total_revenue: 11465.159956, total_units: 865.0; Sold_Date: 2024-03-30, total_revenue: 12130.429914, total_units: 1043.0; Sold_Date: 2024-03-29, total_revenue: 18130.919942, total_units: 1446.0; Sold_Date: 2024-03-28, total_revenue: 12410.239968, total_units: 1033.0; Sold_Date: 2024-03-27, total_revenue: 9486.669932, total_units: 797.0; Sold_Date: 2024-03-26, total_revenue: 8913.299928, total_units: 808.0; Sold_Date: 2024-03-25, total_revenue: 9394.489947, total_units: 814.0; Sold_Date: 2024-03-24, total_revenue: 11490.389904, total_units: 973.0; Sold_Date: 2024-03-22, total_revenue: 14739.649938, total_units: 1310.0; Sold_Date: 2024-03-21, total_revenue: 12593.679940, total_units: 1017.0; Sold_Date: 2024-03-20, total_revenue: 10035.429957, total_units: 723.0; Sold_Date: 2024-03-19, total_revenue: 9781.329939, total_units: 779.0; Sold_Date: 2024-03-18, total_revenue: 8151.019921, total_units: 759.0; Sold_Date: 2024-03-17, total_revenue: 8685.079932, total_units: 723.0; Sold_Date: 2024-03-16, total_revenue: 12654.869916, total_units: 1019.0; Sold_Date: 2024-03-15, total_revenue: 16860.119913, total_units: 1341.0; Sold_Date: 2024-03-14, total_revenue: 12704.229942, total_units: 1104.0; Sold_Date: 2024-03-13, total_revenue: 10113.479960, total_units: 731.0; Sold_Date: 2024-03-12, total_revenue: 9319.179927, total_units: 743.0; Sold_Date: 2024-03-11, total_revenue: 9057.659943, total_units: 718.0; Sold_Date: 2024-03-10, total_revenue: 10858.899962, total_units: 816.0; Sold_Date: 2024-03-09, total_revenue: 12723.899937, total_units: 1012.0; Sold_Date: 2024-03-08, total_revenue: 18448.579874, total_units: 1541.0; Sold_Date: 2024-03-07, total_revenue: 12583.609902, total_units: 1029.0; Sold_Date: 2024-03-06, total_revenue: 10497.679946, total_units: 803.0; Sold_Date: 2024-03-05, total_revenue: 9982.559910, total_units: 730.0; Sold_Date: 2024-03-04, total_revenue: 9461.179928, total_units: 766.0; Sold_Date: 2024-03-03, total_revenue: 11190.739941, total_units: 941.0; Sold_Date: 2024-03-02, total_revenue: 13834.259921, total_units: 1101.0; Sold_Date: 2024-03-01, total_revenue: 16214.309858, total_units: 1499.0"
  },
  {
    "prompt": "For 2022, return the top 25 stores by total units sold for Product_Class_Code = 22975; tie-break by Store_Number ASC; columns: Store_Number, total_units, total_revenue.",
    "gt_sql": "SELECT Store_Number, SUM(Qty_Sold) AS total_units, SUM(Total_Sale_Value) AS total_revenue FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2022 AND Product_Class_Code = 22975 GROUP BY Store_Number ORDER BY total_units DESC, Store_Number ASC LIMIT 25",
    "gt_data": "    Store_Number  total_units  total_revenue\n0           2970       4061.0   67735.229967\n1           3080       3201.0   47103.769739\n2           1210       3179.0   53590.399891\n3           1650       2889.0   51583.809919\n4           3300       2872.0   52745.349853\n5           1100       2748.0   44162.889747\n6           1320       2506.0   50930.190013\n7           2750       2399.0   41942.669923\n8           2420       2239.0   41258.299958\n9           2200       2111.0   39076.459951\n10          2310       2019.0   36246.150019\n11           990       2012.0   41125.950106\n12           880       2005.0   38132.759994\n13          3410       1938.0   33407.269839\n14           330       1913.0   33351.169944\n15           660       1909.0   35899.000001\n16          3630       1898.0   34752.339867\n17          1540       1775.0   30341.179863\n18          1870       1758.0   32101.399936\n19          4840       1744.0   28351.719901\n20          3740       1739.0   30222.319891\n21          2090       1599.0   26344.379813\n22          4070       1576.0   29304.379972\n23          1760       1559.0   30691.659863\n24          3190       1543.0   26704.299887",
    "gt_analysis": "Store_Number: 2970, total_units: 4061.0, total_revenue: 67735.229967; Store_Number: 3080, total_units: 3201.0, total_revenue: 47103.769739; Store_Number: 1210, total_units: 3179.0, total_revenue: 53590.399891; Store_Number: 1650, total_units: 2889.0, total_revenue: 51583.809919; Store_Number: 3300, total_units: 2872.0, total_revenue: 52745.349853; Store_Number: 1100, total_units: 2748.0, total_revenue: 44162.889747; Store_Number: 1320, total_units: 2506.0, total_revenue: 50930.190013; Store_Number: 2750, total_units: 2399.0, total_revenue: 41942.669923; Store_Number: 2420, total_units: 2239.0, total_revenue: 41258.299958; Store_Number: 2200, total_units: 2111.0, total_revenue: 39076.459951; Store_Number: 2310, total_units: 2019.0, total_revenue: 36246.150019; Store_Number: 990, total_units: 2012.0, total_revenue: 41125.950106; Store_Number: 880, total_units: 2005.0, total_revenue: 38132.759994; Store_Number: 3410, total_units: 1938.0, total_revenue: 33407.269839; Store_Number: 330, total_units: 1913.0, total_revenue: 33351.169944; Store_Number: 660, total_units: 1909.0, total_revenue: 35899.000001; Store_Number: 3630, total_units: 1898.0, total_revenue: 34752.339867; Store_Number: 1540, total_units: 1775.0, total_revenue: 30341.179863; Store_Number: 1870, total_units: 1758.0, total_revenue: 32101.399936; Store_Number: 4840, total_units: 1744.0, total_revenue: 28351.719901; Store_Number: 3740, total_units: 1739.0, total_revenue: 30222.319891; Store_Number: 2090, total_units: 1599.0, total_revenue: 26344.379813; Store_Number: 4070, total_units: 1576.0, total_revenue: 29304.379972; Store_Number: 1760, total_units: 1559.0, total_revenue: 30691.659863; Store_Number: 3190, total_units: 1543.0, total_revenue: 26704.299887"
  }
]