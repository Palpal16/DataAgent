[
  {
    "prompt": "Return the 12 months of 2023 with total revenue and total units sold; order by month_start ASC.",
    "gt_sql": "SELECT DATE_TRUNC('month', Sold_Date) as month_start, SUM(Total_Sale_Value) as total_revenue, SUM(Qty_Sold) as total_units_sold FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY DATE_TRUNC('month', Sold_Date) ORDER BY month_start ASC",
    "gt_data": "   month_start  total_revenue  total_units_sold\n0   2023-01-01  434172.808300           33653.0\n1   2023-02-01  411762.718244           31545.0\n2   2023-03-01  423070.838309           32460.0\n3   2023-04-01  384479.678311           30199.0\n4   2023-05-01  381326.428023           31154.0\n5   2023-06-01  364806.737856           29082.0\n6   2023-07-01  353284.207838           27932.0\n7   2023-08-01  401061.537729           31903.0\n8   2023-09-01  422554.967469           31847.0\n9   2023-10-01  454231.057104           38208.0\n10  2023-11-01  511104.287418           41043.0\n11  2023-12-01  874263.668331           60941.0",
    "gt_analysis": "January 2023: \u20ac434,172.81 revenue, 33,653 units; February 2023: \u20ac411,762.72 revenue, 31,545 units; March 2023: \u20ac423,070.84 revenue, 32,460 units; April 2023: \u20ac384,479.68 revenue, 30,199 units; May 2023: \u20ac381,326.43 revenue, 31,154 units; June 2023: \u20ac364,806.74 revenue, 29,082 units; July 2023: \u20ac353,284.21 revenue, 27,932 units; August 2023: \u20ac401,061.54 revenue, 31,903 units; September 2023: \u20ac422,554.97 revenue, 31,847 units; October 2023: \u20ac454,231.06 revenue, 38,208 units; November 2023: \u20ac511,104.29 revenue, 41,043 units; December 2023: \u20ac874,263.67 revenue, 60,941 units.",
    "difficulty": "easy"  
  },
  {
    "prompt": "Return the top 20 SKUs by total units sold across the full dataset; tie-break by higher total revenue, then SKU_Coded ASC.",
    "gt_sql": "SELECT SKU_Coded, SUM(Qty_Sold) as total_units_sold, SUM(Total_Sale_Value) as total_revenue FROM sales GROUP BY SKU_Coded ORDER BY total_units_sold DESC, total_revenue DESC, SKU_Coded ASC LIMIT 20",
    "gt_data": "    SKU_Coded  total_units_sold  total_revenue\n0     6200700           52262.0  515088.125879\n1     6194250           14905.0  296872.717907\n2     6193800           13744.0  102779.887266\n3     6177750           12982.0   24268.139672\n4     6177350           12702.0  107732.197505\n5     6200650           12599.0  125459.188012\n6     6187750           11909.0   94285.607714\n7     6191100           11750.0   93128.078166\n8     6190100           11293.0   14756.900020\n9     6200800           10577.0   25954.219908\n10    6179250            9731.0  145054.308485\n11    6179200            9411.0   52888.138254\n12    6192300            8845.0   35013.700175\n13    6195800            8676.0   84304.989587\n14    6182050            8539.0   67969.048205\n15    6173350            8419.0   73853.650037\n16    6177450            8396.0   41803.148624\n17    6184100            7988.0  158712.088621\n18    6201750            7931.0    7774.890016\n19    6178100            7911.0   39385.088725",
    "gt_analysis": "The top 20 SKUs by total units sold are: 1. SKU 6200700 (52,262 units, \u20ac515,088.13 revenue); 2. SKU 6194250 (14,905 units, \u20ac296,872.72 revenue); 3. SKU 6193800 (13,744 units, \u20ac102,779.89 revenue); 4. SKU 6177750 (12,982 units, \u20ac24,268.14 revenue); 5. SKU 6177350 (12,702 units, \u20ac107,732.20 revenue); 6. SKU 6200650 (12,599 units, \u20ac125,459.19 revenue); 7. SKU 6187750 (11,909 units, \u20ac94,285.61 revenue); 8. SKU 6191100 (11,750 units, \u20ac93,128.08 revenue); 9. SKU 6190100 (11,293 units, \u20ac14,756.90 revenue); 10. SKU 6200800 (10,577 units, \u20ac25,954.22 revenue); 11. SKU 6179250 (9,731 units, \u20ac145,054.31 revenue); 12. SKU 6179200 (9,411 units, \u20ac52,888.14 revenue); 13. SKU 6192300 (8,845 units, \u20ac35,013.70 revenue); 14. SKU 6195800 (8,676 units, \u20ac84,304.99 revenue); 15. SKU 6182050 (8,539 units, \u20ac67,969.05 revenue); 16. SKU 6173350 (8,419 units, \u20ac73,853.65 revenue); 17. SKU 6177450 (8,396 units, \u20ac41,803.15 revenue); 18. SKU 6184100 (7,988 units, \u20ac158,712.09 revenue); 19. SKU 6201750 (7,931 units, \u20ac7,774.89 revenue); 20. SKU 6178100 (7,911 units, \u20ac39,385.09 revenue).",
    "difficulty": "easy"
  },
  {
    "prompt": "For 2022, return the top 15 Product_Class_Code by total revenue; tie-break by higher total units, then Product_Class_Code ASC.",
    "gt_sql": "SELECT Product_Class_Code, SUM(Total_Sale_Value) as total_revenue, SUM(Qty_Sold) as total_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2022 GROUP BY Product_Class_Code ORDER BY total_revenue DESC, total_units DESC, Product_Class_Code ASC LIMIT 15",
    "gt_data": "    Product_Class_Code  total_revenue  total_units\n0                22975   1.135793e+06      64028.0\n1                22800   8.047909e+05      59710.0\n2                24425   7.089950e+05      42726.0\n3                24400   6.123823e+05      43787.0\n4                22850   4.873798e+05      47988.0\n5                22900   4.447206e+05       9750.0\n6                24375   4.390179e+05      13785.0\n7                22875   2.937181e+05      61898.0\n8                22950   1.409884e+05      28590.0\n9                22925   1.197567e+05      16921.0\n10               22825   1.081189e+05      16054.0",
    "gt_analysis": "The top 15 Product Class Codes for 2022 by total revenue are: 1. Product Class 22975 (\u20ac1,135,793 revenue, 64,028 units); 2. Product Class 22800 (\u20ac804,791 revenue, 59,710 units); 3. Product Class 24425 (\u20ac708,995 revenue, 42,726 units); 4. Product Class 24400 (\u20ac612,382 revenue, 43,787 units); 5. Product Class 22850 (\u20ac487,380 revenue, 47,988 units); 6. Product Class 22900 (\u20ac444,721 revenue, 9,750 units); 7. Product Class 24375 (\u20ac439,018 revenue, 13,785 units); 8. Product Class 22875 (\u20ac293,718 revenue, 61,898 units); 9. Product Class 22950 (\u20ac140,988 revenue, 28,590 units); 10. Product Class 22925 (\u20ac119,757 revenue, 16,921 units); 11. Product Class 22825 (\u20ac108,119 revenue, 16,054 units).",
    "difficulty": "easy"
  },
  {
    "prompt": "For 2023, return the top 25 stores by promotional unit share (promo_units/total_units) among stores with at least 100 total units; tie-break by Store_Number ASC.",
    "gt_sql": "SELECT Store_Number, SUM(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END) as promo_units, SUM(Qty_Sold) as total_units, CAST(SUM(CASE WHEN On_Promo = 1 THEN Qty_Sold ELSE 0 END) AS FLOAT) / SUM(Qty_Sold) as promo_share FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY Store_Number HAVING SUM(Qty_Sold) >= 100 ORDER BY promo_share DESC, Store_Number ASC LIMIT 25",
    "gt_data": "    Store_Number  promo_units  total_units  promo_share\n0           2860        250.0       7319.0     0.034158\n1           3190        360.0      11260.0     0.031972\n2            770        312.0      10359.0     0.030119\n3           1980        223.0       8577.0     0.026000\n4           1540        299.0      12159.0     0.024591\n5           2640        290.0      12264.0     0.023646\n6           2090        230.0      10296.0     0.022339\n7            990        252.0      11292.0     0.022317\n8           3520        144.0       7010.0     0.020542\n9           4180        173.0       8472.0     0.020420\n10          4070        235.0      12113.0     0.019401\n11          3740        212.0      10937.0     0.019384\n12          2420        284.0      15180.0     0.018709\n13          2530        179.0      10049.0     0.017813\n14          4730        122.0       7681.0     0.015883\n15          1100        243.0      15799.0     0.015381\n16          2310        186.0      12332.0     0.015083\n17          3630        206.0      14123.0     0.014586\n18          3080        195.0      13391.0     0.014562\n19          2200        141.0       9795.0     0.014395\n20          1870        150.0      11193.0     0.013401\n21          2750        184.0      13863.0     0.013273\n22          4840        142.0      11708.0     0.012128\n23          1320        235.0      19443.0     0.012087\n24           330        140.0      11879.0     0.011786",
    "gt_analysis": "The top 25 stores in 2023 by promotional unit share (with at least 100 total units) are: 1. Store 2860 (3.42% promo share, 250 promo units, 7,319 total units); 2. Store 3190 (3.20% promo share, 360 promo units, 11,260 total units); 3. Store 770 (3.01% promo share, 312 promo units, 10,359 total units); 4. Store 1980 (2.60% promo share, 223 promo units, 8,577 total units); 5. Store 1540 (2.46% promo share, 299 promo units, 12,159 total units); 6. Store 2640 (2.36% promo share, 290 promo units, 12,264 total units); 7. Store 2090 (2.23% promo share, 230 promo units, 10,296 total units); 8. Store 990 (2.23% promo share, 252 promo units, 11,292 total units); 9. Store 3520 (2.05% promo share, 144 promo units, 7,010 total units); 10. Store 4180 (2.04% promo share, 173 promo units, 8,472 total units); 11. Store 4070 (1.94% promo share, 235 promo units, 12,113 total units); 12. Store 3740 (1.94% promo share, 212 promo units, 10,937 total units); 13. Store 2420 (1.87% promo share, 284 promo units, 15,180 total units); 14. Store 2530 (1.78% promo share, 179 promo units, 10,049 total units); 15. Store 4730 (1.59% promo share, 122 promo units, 7,681 total units); 16. Store 1100 (1.54% promo share, 243 promo units, 15,799 total units); 17. Store 2310 (1.51% promo share, 186 promo units, 12,332 total units); 18. Store 3630 (1.46% promo share, 206 promo units, 14,123 total units); 19. Store 3080 (1.46% promo share, 195 promo units, 13,391 total units); 20. Store 2200 (1.44% promo share, 141 promo units, 9,795 total units); 21. Store 1870 (1.34% promo share, 150 promo units, 11,193 total units); 22. Store 2750 (1.33% promo share, 184 promo units, 13,863 total units); 23. Store 4840 (1.21% promo share, 142 promo units, 11,708 total units); 24. Store 1320 (1.21% promo share, 235 promo units, 19,443 total units); 25. Store 330 (1.18% promo share, 140 promo units, 11,879 total units).",
    "difficulty": "easy"
  },
  {
    "prompt": "For Q1 2023 (2023-01-01 to 2023-03-31), return the top 30 stores by total revenue; tie-break by Store_Number ASC.",
    "gt_sql": "SELECT Store_Number, SUM(Total_Sale_Value) as total_revenue FROM sales WHERE Sold_Date >= '2023-01-01' AND Sold_Date <= '2023-03-31' GROUP BY Store_Number ORDER BY total_revenue DESC, Store_Number ASC LIMIT 30",
    "gt_data": "    Store_Number  total_revenue\n0           2970   76853.159734\n1           3300   66626.309749\n2           1320   62172.839858\n3           1650   56220.139782\n4           1100   51486.119914\n5           3080   48145.879883\n6           1210   43959.729856\n7           2420   43363.629744\n8           2750   43234.119773\n9            880   42863.479745\n10          3630   40257.639818\n11          2310   38919.459938\n12          1540   37388.279729\n13           660   37187.619883\n14          1870   36756.709768\n15          4840   36607.989831\n16          3410   36513.879942\n17          2090   35334.039831\n18          4070   35114.819833\n19           330   34503.009759\n20           990   34048.199931\n21          3740   32873.009876\n22          1760   32860.329846\n23          2200   31966.259884\n24          3190   31134.779882\n25           770   29096.689838\n26          2640   27016.909833\n27          4180   24823.079898\n28           550   24038.359882\n29          2530   23853.799933",
    "gt_analysis": "The top 30 stores by total revenue in Q1 2023 are: 1. Store 2970 (\u20ac76,853.16); 2. Store 3300 (\u20ac66,626.31); 3. Store 1320 (\u20ac62,172.84); 4. Store 1650 (\u20ac56,220.14); 5. Store 1100 (\u20ac51,486.12); 6. Store 3080 (\u20ac48,145.88); 7. Store 1210 (\u20ac43,959.73); 8. Store 2420 (\u20ac43,363.63); 9. Store 2750 (\u20ac43,234.12); 10. Store 880 (\u20ac42,863.48); 11. Store 3630 (\u20ac40,257.64); 12. Store 2310 (\u20ac38,919.46); 13. Store 1540 (\u20ac37,388.28); 14. Store 660 (\u20ac37,187.62); 15. Store 1870 (\u20ac36,756.71); 16. Store 4840 (\u20ac36,607.99); 17. Store 3410 (\u20ac36,513.88); 18. Store 2090 (\u20ac35,334.04); 19. Store 4070 (\u20ac35,114.82); 20. Store 330 (\u20ac34,503.01); 21. Store 990 (\u20ac34,048.20); 22. Store 3740 (\u20ac32,873.01); 23. Store 1760 (\u20ac32,860.33); 24. Store 2200 (\u20ac31,966.26); 25. Store 3190 (\u20ac31,134.78); 26. Store 770 (\u20ac29,096.69); 27. Store 2640 (\u20ac27,016.91); 28. Store 4180 (\u20ac24,823.08); 29. Store 550 (\u20ac24,038.36); 30. Store 2530 (\u20ac23,853.80).",
    "difficulty": "easy"
  },
  {
    "prompt": "For 2023, return the top 10 SKUs by total revenue with avg unit price = sum(Total_Sale_Value)/sum(Qty_Sold); tie-break by SKU_Coded ASC.",
    "gt_sql": "SELECT SKU_Coded, SUM(Total_Sale_Value) as total_revenue, SUM(Qty_Sold) as total_units, SUM(Total_Sale_Value) / SUM(Qty_Sold) as avg_unit_price FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY SKU_Coded ORDER BY total_revenue DESC, SKU_Coded ASC LIMIT 10",
    "gt_data": "   SKU_Coded  total_revenue  total_units  avg_unit_price\n0    6200700  353964.937498      36081.0        9.810286\n1    6184900  147797.616945       1651.0       89.520059\n2    6194250  116109.579178       5824.0       19.936398\n3    6200650   83765.828704       8405.0        9.966190\n4    6191400   70791.602219       1581.0       44.776472\n5    6184100   67589.119407       3396.0       19.902568\n6    6186250   66756.588099        960.0       69.538113\n7    6176200   60119.691723       1086.0       55.358832\n8    6199250   57957.061886       1273.0       45.527935\n9    6179250   54660.029366       3675.0       14.873477",
    "gt_analysis": "The top 10 SKUs by total revenue in 2023 are: 1. SKU 6200700 (\u20ac353,964.94 revenue, 36,081 units, \u20ac9.81 avg unit price); 2. SKU 6184900 (\u20ac147,797.62 revenue, 1,651 units, \u20ac89.52 avg unit price); 3. SKU 6194250 (\u20ac116,109.58 revenue, 5,824 units, \u20ac19.94 avg unit price); 4. SKU 6200650 (\u20ac83,765.83 revenue, 8,405 units, \u20ac9.97 avg unit price); 5. SKU 6191400 (\u20ac70,791.60 revenue, 1,581 units, \u20ac44.78 avg unit price); 6. SKU 6184100 (\u20ac67,589.12 revenue, 3,396 units, \u20ac19.90 avg unit price); 7. SKU 6186250 (\u20ac66,756.59 revenue, 960 units, \u20ac69.54 avg unit price); 8. SKU 6176200 (\u20ac60,119.69 revenue, 1,086 units, \u20ac55.36 avg unit price); 9. SKU 6199250 (\u20ac57,957.06 revenue, 1,273 units, \u20ac45.53 avg unit price); 10. SKU 6179250 (\u20ac54,660.03 revenue, 3,675 units, \u20ac14.87 avg unit price).",
    "difficulty": "medium"
  },
  {
    "prompt": "For 2023, return month-by-promo aggregates; order by month_start ASC, On_Promo ASC; expect 24 rows.",
    "gt_sql": "SELECT DATE_TRUNC('month', Sold_Date) as month_start, On_Promo, SUM(Total_Sale_Value) as total_revenue, SUM(Qty_Sold) as total_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY DATE_TRUNC('month', Sold_Date), On_Promo ORDER BY month_start ASC, On_Promo ASC",
    "gt_data": "   month_start  On_Promo  total_revenue  total_units\n0   2023-01-01         0  434102.828296      33651.0\n1   2023-01-01         1      69.980003          2.0\n2   2023-02-01         0  411762.718244      31545.0\n3   2023-03-01         0  423070.838309      32460.0\n4   2023-04-01         0  378326.478314      29351.0\n5   2023-04-01         1    6153.199997        848.0\n6   2023-05-01         0  379860.538039      30943.0\n7   2023-05-01         1    1465.889984        211.0\n8   2023-06-01         0  364806.737856      29082.0\n9   2023-07-01         0  353284.207838      27932.0\n10  2023-08-01         0  398592.447746      31612.0\n11  2023-08-01         1    2469.089983        291.0\n12  2023-09-01         0  415126.857461      31789.0\n13  2023-09-01         1    7428.110008         58.0\n14  2023-10-01         0  446184.807069      36423.0\n15  2023-10-01         1    8046.250035       1785.0\n16  2023-11-01         0  476004.377225      39141.0\n17  2023-11-01         1   35099.910192       1902.0\n18  2023-12-01         0  835289.237587      59511.0\n19  2023-12-01         1   38974.430744       1430.0",
    "gt_analysis": "For 2023, the month-by-promo aggregates are (20 rows returned, not 24): January 2023 Non-Promo (\u20ac434,102.83 revenue, 33,651 units); January 2023 Promo (\u20ac69.98 revenue, 2 units); February 2023 Non-Promo (\u20ac411,762.72 revenue, 31,545 units); March 2023 Non-Promo (\u20ac423,070.84 revenue, 32,460 units); April 2023 Non-Promo (\u20ac378,326.48 revenue, 29,351 units); April 2023 Promo (\u20ac6,153.20 revenue, 848 units); May 2023 Non-Promo (\u20ac379,860.54 revenue, 30,943 units); May 2023 Promo (\u20ac1,465.89 revenue, 211 units); June 2023 Non-Promo (\u20ac364,806.74 revenue, 29,082 units); July 2023 Non-Promo (\u20ac353,284.21 revenue, 27,932 units); August 2023 Non-Promo (\u20ac398,592.45 revenue, 31,612 units); August 2023 Promo (\u20ac2,469.09 revenue, 291 units); September 2023 Non-Promo (\u20ac415,126.86 revenue, 31,789 units); September 2023 Promo (\u20ac7,428.11 revenue, 58 units); October 2023 Non-Promo (\u20ac446,184.81 revenue, 36,423 units); October 2023 Promo (\u20ac8,046.25 revenue, 1,785 units); November 2023 Non-Promo (\u20ac476,004.38 revenue, 39,141 units); November 2023 Promo (\u20ac35,099.91 revenue, 1,902 units); December 2023 Non-Promo (\u20ac835,289.24 revenue, 59,511 units); December 2023 Promo (\u20ac38,974.43 revenue, 1,430 units).",
    "difficulty": "medium"
  },
  {
    "prompt": "For 2023, return the top 50 stores by distinct SKUs sold; tie-break by Store_Number ASC.",
    "gt_sql": "SELECT Store_Number, COUNT(DISTINCT SKU_Coded) as distinct_skus FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 GROUP BY Store_Number ORDER BY distinct_skus DESC, Store_Number ASC LIMIT 50",
    "gt_data": "    Store_Number  distinct_skus\n0           2640            453\n1           1320            449\n2           3300            448\n3            990            447\n4           1540            447\n5           2310            446\n6           2970            446\n7           2090            444\n8           3190            443\n9           3410            443\n10          3630            443\n11          4840            443\n12          1650            441\n13          2420            441\n14          4070            440\n15          4180            438\n16          1100            437\n17          4730            437\n18          2200            436\n19          2530            436\n20          2750            435\n21          3080            434\n22          3740            433\n23          1870            429\n24          1980            428\n25          1760            427\n26          2860            427\n27          3520            427\n28          1210            420\n29           880            402\n30           660            398\n31           330            391\n32           770            387\n33           550            379\n34          4400            245",
    "gt_analysis": "The top 50 stores by distinct SKUs sold in 2023 are: 1. Store 2640 (453 distinct SKUs); 2. Store 1320 (449 distinct SKUs); 3. Store 3300 (448 distinct SKUs); 4. Store 990 (447 distinct SKUs); 5. Store 1540 (447 distinct SKUs); 6. Store 2310 (446 distinct SKUs); 7. Store 2970 (446 distinct SKUs); 8. Store 2090 (444 distinct SKUs); 9. Store 3190 (443 distinct SKUs); 10. Store 3410 (443 distinct SKUs); 11. Store 3630 (443 distinct SKUs); 12. Store 4840 (443 distinct SKUs); 13. Store 1650 (441 distinct SKUs); 14. Store 2420 (441 distinct SKUs); 15. Store 4070 (440 distinct SKUs); 16. Store 4180 (438 distinct SKUs); 17. Store 1100 (437 distinct SKUs); 18. Store 4730 (437 distinct SKUs); 19. Store 2200 (436 distinct SKUs); 20. Store 2530 (436 distinct SKUs); 21. Store 2750 (435 distinct SKUs); 22. Store 3080 (434 distinct SKUs); 23. Store 3740 (433 distinct SKUs); 24. Store 1870 (429 distinct SKUs); 25. Store 1980 (428 distinct SKUs); 26. Store 1760 (427 distinct SKUs); 27. Store 2860 (427 distinct SKUs); 28. Store 3520 (427 distinct SKUs); 29. Store 1210 (420 distinct SKUs); 30. Store 880 (402 distinct SKUs); 31. Store 660 (398 distinct SKUs); 32. Store 330 (391 distinct SKUs); 33. Store 770 (387 distinct SKUs); 34. Store 550 (379 distinct SKUs); 35. Store 4400 (245 distinct SKUs).",
    "difficulty" : "medium"
  },
  {
    "prompt": "For 2023, return the top 30 Product_Class_Code by promotional units sold (On_Promo=1); tie-break by Product_Class_Code ASC.",
    "gt_sql": "SELECT Product_Class_Code, SUM(Qty_Sold) as promo_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2023 AND On_Promo = 1 GROUP BY Product_Class_Code ORDER BY promo_units DESC, Product_Class_Code ASC LIMIT 30",
    "gt_data": "   Product_Class_Code  promo_units\n0               22850       4048.0\n1               22975        863.0\n2               24425        763.0\n3               22900        761.0\n4               22950         92.0",
    "gt_analysis": "The top 30 Product Class Codes by promotional units sold in 2023 are (5 rows returned): 1. Product Class 22850 (4,048 promo units); 2. Product Class 22975 (863 promo units); 3. Product Class 24425 (763 promo units); 4. Product Class 22900 (761 promo units); 5. Product Class 22950 (92 promo units).",
    "difficulty": "medium"
  },
  {
    "prompt": "Across the full dataset, return the 40 SKUs with the highest average unit price among SKUs with at least 50 units sold; avg_unit_price = sum(Total_Sale_Value)/sum(Qty_Sold); tie-break by SKU_Coded ASC.",
    "gt_sql": "SELECT SKU_Coded, SUM(Total_Sale_Value) as total_revenue, SUM(Qty_Sold) as total_units, SUM(Total_Sale_Value) / SUM(Qty_Sold) as avg_unit_price FROM sales GROUP BY SKU_Coded HAVING SUM(Qty_Sold) >= 50 ORDER BY avg_unit_price DESC, SKU_Coded ASC LIMIT 40",
    "gt_data": "    SKU_Coded  total_revenue  total_units  avg_unit_price\n0     6204850   61797.711670        415.0      148.910149\n1     6204800   61129.980629        540.0      113.203668\n2     6185100  132404.327278       1330.0       99.552126\n3     6195750   13399.509682        149.0       89.929595\n4     6184900  341808.952810       3817.0       89.549110\n5     6179650   51841.438976        607.0       85.405995\n6     6202800   11994.499710        150.0       79.963331\n7     6202350   46608.888786        585.0       79.673314\n8     6197600   76555.637985        961.0       79.662474\n9     6202500   23449.639423        297.0       78.955015\n10    6186250  163875.155296       2358.0       69.497521\n11    6203450    6646.049843         96.0       69.229686\n12    6198500   26942.199215        391.0       68.905880\n13    6195250   34411.530737        569.0       60.477207\n14    6185150   25501.630703        427.0       59.722789\n15    6202900   10459.980293        177.0       59.095934\n16    6196350   36046.020971        619.0       58.232667\n17    6176250  146405.814148       2645.0       55.351915\n18    6176200  149519.704277       2702.0       55.336678\n19    6192500   73951.592205       1352.0       54.697923\n20    6196200   74035.371582       1366.0       54.198661\n21    6197000    5401.869850        101.0       53.483860\n22    6179600  104083.253410       2090.0       49.800600\n23    6187700   12648.320265        255.0       49.601256\n24    6190450  105843.023338       2136.0       49.551977\n25    6200000   33296.191074        672.0       49.547903\n26    6198550   21100.930643        426.0       49.532701\n27    6199050   34331.081085        694.0       49.468417\n28    6190500   59138.981873       1196.0       49.447309\n29    6193250   23685.140501        484.0       48.936241\n30    6196550   50185.581646       1039.0       48.301811\n31    6191400  264871.067286       5657.0       46.821826\n32    6199300   85212.582848       1828.0       46.615198\n33    6193200  120931.813671       2627.0       46.034189\n34    6199150   70299.682259       1532.0       45.887521\n35    6199250  106781.093248       2341.0       45.613453\n36    6188750   13648.960375        301.0       45.345383\n37    6199100   40699.251480        910.0       44.724452\n38    6200550   23030.870823        518.0       44.461141\n39    6196500   23145.570544        531.0       43.588645",
    "gt_analysis": "The 40 SKUs with the highest average unit price (with at least 50 units sold) are: 1. SKU 6204850 (\u20ac148.91 avg price, \u20ac61,797.71 revenue, 415 units); 2. SKU 6204800 (\u20ac113.20 avg price, \u20ac61,129.98 revenue, 540 units); 3. SKU 6185100 (\u20ac99.55 avg price, \u20ac132,404.33 revenue, 1,330 units); 4. SKU 6195750 (\u20ac89.93 avg price, \u20ac13,399.51 revenue, 149 units); 5. SKU 6184900 (\u20ac89.55 avg price, \u20ac341,808.95 revenue, 3,817 units); 6. SKU 6179650 (\u20ac85.41 avg price, \u20ac51,841.44 revenue, 607 units); 7. SKU 6202800 (\u20ac79.96 avg price, \u20ac11,994.50 revenue, 150 units); 8. SKU 6202350 (\u20ac79.67 avg price, \u20ac46,608.89 revenue, 585 units); 9. SKU 6197600 (\u20ac79.66 avg price, \u20ac76,555.64 revenue, 961 units); 10. SKU 6202500 (\u20ac78.96 avg price, \u20ac23,449.64 revenue, 297 units); 11. SKU 6186250 (\u20ac69.50 avg price, \u20ac163,875.16 revenue, 2,358 units); 12. SKU 6203450 (\u20ac69.23 avg price, \u20ac6,646.05 revenue, 96 units); 13. SKU 6198500 (\u20ac68.91 avg price, \u20ac26,942.20 revenue, 391 units); 14. SKU 6195250 (\u20ac60.48 avg price, \u20ac34,411.53 revenue, 569 units); 15. SKU 6185150 (\u20ac59.72 avg price, \u20ac25,501.63 revenue, 427 units); 16. SKU 6202900 (\u20ac59.10 avg price, \u20ac10,459.98 revenue, 177 units); 17. SKU 6196350 (\u20ac58.23 avg price, \u20ac36,046.02 revenue, 619 units); 18. SKU 6176250 (\u20ac55.35 avg price, \u20ac146,405.81 revenue, 2,645 units); 19. SKU 6176200 (\u20ac55.34 avg price, \u20ac149,519.70 revenue, 2,702 units); 20. SKU 6192500 (\u20ac54.70 avg price, \u20ac73,951.59 revenue, 1,352 units); 21. SKU 6196200 (\u20ac54.20 avg price, \u20ac74,035.37 revenue, 1,366 units); 22. SKU 6197000 (\u20ac53.48 avg price, \u20ac5,401.87 revenue, 101 units); 23. SKU 6179600 (\u20ac49.80 avg price, \u20ac104,083.25 revenue, 2,090 units); 24. SKU 6187700 (\u20ac49.60 avg price, \u20ac12,648.32 revenue, 255 units); 25. SKU 6190450 (\u20ac49.55 avg price, \u20ac105,843.02 revenue, 2,136 units); 26. SKU 6200000 (\u20ac49.55 avg price, \u20ac33,296.19 revenue, 672 units); 27. SKU 6198550 (\u20ac49.53 avg price, \u20ac21,100.93 revenue, 426 units); 28. SKU 6199050 (\u20ac49.47 avg price, \u20ac34,331.08 revenue, 694 units); 29. SKU 6190500 (\u20ac49.45 avg price, \u20ac59,138.98 revenue, 1,196 units); 30. SKU 6193250 (\u20ac48.94 avg price, \u20ac23,685.14 revenue, 484 units); 31. SKU 6196550 (\u20ac48.30 avg price, \u20ac50,185.58 revenue, 1,039 units); 32. SKU 6191400 (\u20ac46.82 avg price, \u20ac264,871.07 revenue, 5,657 units); 33. SKU 6199300 (\u20ac46.62 avg price, \u20ac85,212.58 revenue, 1,828 units); 34. SKU 6193200 (\u20ac46.03 avg price, \u20ac120,931.81 revenue, 2,627 units); 35. SKU 6199150 (\u20ac45.89 avg price, \u20ac70,299.68 revenue, 1,532 units); 36. SKU 6199250 (\u20ac45.61 avg price, \u20ac106,781.09 revenue, 2,341 units); 37. SKU 6188750 (\u20ac45.35 avg price, \u20ac13,648.96 revenue, 301 units); 38. SKU 6199100 (\u20ac44.72 avg price, \u20ac40,699.25 revenue, 910 units); 39. SKU 6200550 (\u20ac44.46 avg price, \u20ac23,030.87 revenue, 518 units); 40. SKU 6196500 (\u20ac43.59 avg price, \u20ac23,145.57 revenue, 531 units).",
    "difficulty": "hard"
  },
  {
    "prompt": "Return the 30 most recent Sold_Date values aggregated by date; order by Sold_Date DESC.",
    "gt_sql": "SELECT Sold_Date, SUM(Total_Sale_Value) as total_revenue, SUM(Qty_Sold) as total_units FROM sales GROUP BY Sold_Date ORDER BY Sold_Date DESC LIMIT 30",
    "gt_data": "    Sold_Date  total_revenue  total_units\n0  2024-03-31   11465.159956        865.0\n1  2024-03-30   12130.429914       1043.0\n2  2024-03-29   18130.919942       1446.0\n3  2024-03-28   12410.239968       1033.0\n4  2024-03-27    9486.669932        797.0\n5  2024-03-26    8913.299928        808.0\n6  2024-03-25    9394.489947        814.0\n7  2024-03-24   11490.389904        973.0\n8  2024-03-22   14739.649938       1310.0\n9  2024-03-21   12593.679940       1017.0\n10 2024-03-20   10035.429957        723.0\n11 2024-03-19    9781.329939        779.0\n12 2024-03-18    8151.019921        759.0\n13 2024-03-17    8685.079932        723.0\n14 2024-03-16   12654.869916       1019.0\n15 2024-03-15   16860.119913       1341.0\n16 2024-03-14   12704.229942       1104.0\n17 2024-03-13   10113.479960        731.0\n18 2024-03-12    9319.179927        743.0\n19 2024-03-11    9057.659943        718.0\n20 2024-03-10   10858.899962        816.0\n21 2024-03-09   12723.899937       1012.0\n22 2024-03-08   18448.579874       1541.0\n23 2024-03-07   12583.609902       1029.0\n24 2024-03-06   10497.679946        803.0\n25 2024-03-05    9982.559910        730.0\n26 2024-03-04    9461.179928        766.0\n27 2024-03-03   11190.739941        941.0\n28 2024-03-02   13834.259921       1101.0\n29 2024-03-01   16214.309858       1499.0",
    "gt_analysis": "The 30 most recent sold dates are: 2024-03-31 (\u20ac11,465.16 revenue, 865 units); 2024-03-30 (\u20ac12,130.43 revenue, 1,043 units); 2024-03-29 (\u20ac18,130.92 revenue, 1,446 units); 2024-03-28 (\u20ac12,410.24 revenue, 1,033 units); 2024-03-27 (\u20ac9,486.67 revenue, 797 units); 2024-03-26 (\u20ac8,913.30 revenue, 808 units); 2024-03-25 (\u20ac9,394.49 revenue, 814 units); 2024-03-24 (\u20ac11,490.39 revenue, 973 units); 2024-03-22 (\u20ac14,739.65 revenue, 1,310 units); 2024-03-21 (\u20ac12,593.68 revenue, 1,017 units); 2024-03-20 (\u20ac10,035.43 revenue, 723 units); 2024-03-19 (\u20ac9,781.33 revenue, 779 units); 2024-03-18 (\u20ac8,151.02 revenue, 759 units); 2024-03-17 (\u20ac8,685.08 revenue, 723 units); 2024-03-16 (\u20ac12,654.87 revenue, 1,019 units); 2024-03-15 (\u20ac16,860.12 revenue, 1,341 units); 2024-03-14 (\u20ac12,704.23 revenue, 1,104 units); 2024-03-13 (\u20ac10,113.48 revenue, 731 units); 2024-03-12 (\u20ac9,319.18 revenue, 743 units); 2024-03-11 (\u20ac9,057.66 revenue, 718 units); 2024-03-10 (\u20ac10,858.90 revenue, 816 units); 2024-03-09 (\u20ac12,723.90 revenue, 1,012 units); 2024-03-08 (\u20ac18,448.58 revenue, 1,541 units); 2024-03-07 (\u20ac12,583.61 revenue, 1,029 units); 2024-03-06 (\u20ac10,497.68 revenue, 803 units); 2024-03-05 (\u20ac9,982.56 revenue, 730 units); 2024-03-04 (\u20ac9,461.18 revenue, 766 units); 2024-03-03 (\u20ac11,190.74 revenue, 941 units); 2024-03-02 (\u20ac13,834.26 revenue, 1,101 units); 2024-03-01 (\u20ac16,214.31 revenue, 1,499 units).",
    "difficulty": "medium"
  },
  {
    "prompt": "For 2022, return the top 25 stores by total units sold for Product_Class_Code = 22975; tie-break by Store_Number ASC.",
    "gt_sql": "SELECT Store_Number, SUM(Qty_Sold) as total_units FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2022 AND Product_Class_Code = 22975 GROUP BY Store_Number ORDER BY total_units DESC, Store_Number ASC LIMIT 25",
    "gt_data": "    Store_Number  total_units\n0           2970       4061.0\n1           3080       3201.0\n2           1210       3179.0\n3           1650       2889.0\n4           3300       2872.0\n5           1100       2748.0\n6           1320       2506.0\n7           2750       2399.0\n8           2420       2239.0\n9           2200       2111.0\n10          2310       2019.0\n11           990       2012.0\n12           880       2005.0\n13          3410       1938.0\n14           330       1913.0\n15           660       1909.0\n16          3630       1898.0\n17          1540       1775.0\n18          1870       1758.0\n19          4840       1744.0\n20          3740       1739.0\n21          2090       1599.0\n22          4070       1576.0\n23          1760       1559.0\n24          3190       1543.0",
    "gt_analysis": "The top 25 stores by total units sold for Product Class Code 22975 in 2022 are: 1. Store 2970 (4,061 units); 2. Store 3080 (3,201 units); 3. Store 1210 (3,179 units); 4. Store 1650 (2,889 units); 5. Store 3300 (2,872 units); 6. Store 1100 (2,748 units); 7. Store 1320 (2,506 units); 8. Store 2750 (2,399 units); 9. Store 2420 (2,239 units); 10. Store 2200 (2,111 units); 11. Store 2310 (2,019 units); 12. Store 990 (2,012 units); 13. Store 880 (2,005 units); 14. Store 3410 (1,938 units); 15. Store 330 (1,913 units); 16. Store 660 (1,909 units); 17. Store 3630 (1,898 units); 18. Store 1540 (1,775 units); 19. Store 1870 (1,758 units); 20. Store 4840 (1,744 units); 21. Store 3740 (1,739 units); 22. Store 2090 (1,599 units); 23. Store 4070 (1,576 units); 24. Store 1760 (1,559 units); 25. Store 3190 (1,543 units).",
    "difficulty": "medium"
  },
  {
    "prompt": "For 2022, return the top 25 stores by total units sold for Product_Class_Code = 22975; tie-break by Store_Number ASC.What is the mean of the sales of october month of 2022",
    "gt_sql": "SELECT AVG(Total_Sale_Value) FROM (SELECT s.Store_Number, SUM(s.Qty_Sold) as total_units FROM sales s WHERE EXTRACT(YEAR FROM s.Sold_Date) = 2022 AND s.Product_Class_Code = 22975 GROUP BY s.Store_Number ORDER BY total_units DESC, s.Store_Number ASC LIMIT 25) top_stores JOIN sales s ON top_stores.Store_Number = s.Store_Number WHERE EXTRACT(YEAR FROM s.Sold_Date) = 2022 AND EXTRACT(MONTH FROM s.Sold_Date) = 10",
    "gt_data": "   avg(Total_Sale_Value)\n0              19.634083",
    "gt_analysis": "The mean of the sales in October 2022 for the top 25 stores by total units sold for Product_Class_Code = 22975 is 19.63.",
    "difficulty": "hard"
  },
  {
    "prompt": "How many skus have been sold in the month of september 2022",
    "gt_sql": "SELECT COUNT(DISTINCT SKU_Coded) FROM sales WHERE EXTRACT(YEAR FROM Sold_Date) = 2022 AND EXTRACT(MONTH FROM Sold_Date) = 9",
    "gt_data": "   count(DISTINCT SKU_Coded)\n0                        415",
    "gt_analysis": "415 distinct SKUs were sold in September 2022.",
    "difficulty": "easy"
  }
]